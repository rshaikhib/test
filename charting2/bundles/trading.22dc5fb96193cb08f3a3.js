(window.webpackJsonp=window.webpackJsonp||[]).push([["trading"],{"+J+G":function(t,e,i){t.exports=i.p+"alarm_clock.48d3df0afe4d4981523b8a12e4e25f92.mp3"},"+xnd":function(t,e,i){"use strict";var r;i.d(e,"a",(function(){return r})),function(t){t.Default="default",t.Success="success",t.Warning="warning",t.Danger="danger"}(r||(r={}))},"0jws":function(t,e,i){t.exports={blockHidden:"blockHidden-pECc1q1w","pane-button":"pane-button-3IbFaPrJ"}},"1rjR":function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i("mrSG"),o=(i("HbRj"),i("YFKU"),i("5det")),n={get:function(){return this},open:function(t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Object(o.a)(window.t("Cancel Order"),window.t("Are you sure you want to cancel order {orderId}?").format({orderId:t}))]}))}))},multiple:function(t,e,i){return Object(r.b)(this,void 0,void 0,(function(){var n;return Object(r.d)(this,(function(r){return n=t,void 0!==e&&(n+=" ",n+=1===e?window.t("BUY"):window.t("SELL")),[2,Object(o.a)(window.t("Cancel Order"),window.t("Are you sure you want to cancel {qty} {side} orders?").format({qty:String(i),side:n}))]}))}))}}},"2TBc":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("Eyy1"),o=function(){function t(t){this._activeBroker=null,this._trading=t,this._trading.onConnectionStatusChange.subscribe(this,this._onStatusChange),this._onStatusChange(this._trading.connectStatus())}return t.prototype.activeBroker=function(){return this._activeBroker},t.prototype.trading=function(){return this._trading},t.prototype._stopService=function(){this.stopService(),Object(r.ensureNotNull)(this._activeBroker).currentAccountUpdate.unsubscribeAll(this)},t.prototype._startService=function(){this.startService(),Object(r.ensureNotNull)(this._activeBroker).currentAccountUpdate.subscribe(this,this._onCurrentAccountUpdate)},t.prototype._onStatusChange=function(t){var e=this._trading.activeBroker();this._activeBroker===e&&1===t||(null!==this._activeBroker&&(this._stopService(),this._activeBroker=null),null!==e&&1===t&&(this._activeBroker=e,this._startService(),this._lastAccountId=e.currentAccount()))},t.prototype._onCurrentAccountUpdate=function(){var t=Object(r.ensureNotNull)(this._activeBroker);this._lastAccountId!==t.currentAccount()&&(this.stopService(),this.startService(),this._lastAccountId=t.currentAccount())},t}()},"5XxY":function(t,e,i){"use strict";i("HbRj"),i("YFKU");var r=i("mrSG");i.d(e,"a",(function(){return o}));var o={show:function(t,e){!function(t,e,o){Object(r.b)(this,void 0,void 0,(function(){var n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,Promise.all([i.e("react"),i.e(1),i.e(154),i.e("notification-dialog-renderer")]).then(i.bind(null,"G96Q"))];case 1:return n=r.sent().NotificationDialogRenderer,[4,(new n).open(t,e,o)];case 2:return[2,r.sent().status]}}))}))}(t,e)}}},"5det":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("mrSG");i("HbRj"),i("YFKU");function o(t,e,o,n){return Object(r.b)(this,void 0,void 0,(function(){
var s,a,c;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,Promise.all([i.e("react"),i.e(1),i.e(153),i.e("confirm-dialog-renderer")]).then(i.bind(null,"WY8x"))];case 1:return s=r.sent().ConfirmDialogRenderer,a=new s,c={title:t,message:e,closeButton:null!=n?n:window.t("No"),confirmButton:null!=o?o:window.t("Yes")},[4,a.open(c)];case 2:return[2,r.sent().status]}}))}))}},"6aj4":function(t,e,i){t.exports={"trading-panel-content":"trading-panel-content-1fMpgHzg","trading-panel-spinner":"trading-panel-spinner-302GKpcG","trading-panel-handle":"trading-panel-handle-31nauMFK"}},"8Wzo":function(t,e,i){"use strict";var r;i.d(e,"a",(function(){return r})),function(t){t[t.StopLoss=0]="StopLoss",t[t.TrailingStop=1]="TrailingStop"}(r||(r={}))},"8wgr":function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r={ACTIVE_BROKER:"trading.active_broker",FILTER_BROKER:"trading.filter_brokers_by_locale",PROPERTIES:"trading.chart.proterty",QTY:"trading.qty.",BROKERS_QTY:"trading.brokers.qty",PROFIT_VIEW_TYPE:"trading.dom.profitViewType",ORDER_WIDGET_MODE:"trading.orderWidgetMode.",TAKE_PROFIT:"trading.takeprofit.",STOP_LOSS:"trading.stoploss.",ORDER_DURATION:"trading.orderDuration.",DOM_DURATION:"trading.domDuration.",TRADING_PANEL_OPENED:"trading.tradingPanelOpened",TRADING_PANEL_ACTIVE_PAGE:"trading.tradingPanelActivePage",PANEL_WIDTH:"trading.panelWidth",PANEL_HEIGHT:"trading.panelHeight",ORDER_PANEL_SETTINGS:"trading.orderPanelSettings",FAVORITE_BROKERS:"trading.panelFavorite",REVIEW_DIALOG_WAS_SHOWED:"trading.reviewDialogShowedOnLogin",SHOW_TOOLTIP_FOR_SELECT_BROKER:"trading.showTooltipForSelectBroker",LOGIN_COUNTER:"trading.brokerLogInCounter",LOGOUT_COUNTER:"trading.brokerLogOutCounter"}},"9pog":function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i("zXvd"),o=["","K","M","G","T","Y"];function n(t){if(t<1)return r.NumericFormatter.formatNoE(t);var e=0,i=+t;if(isFinite(i))for(;i>=1e3&&i%100==0;)e++,i/=1e3;return i+(e<o.length?o[e]:"e"+3*e)}},AvGy:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("qFKp"),o=r.CheckMobile.any()},C9TK:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i("mrSG"),o=(i("HbRj"),i("5det"));function n(t,e,i,n){return Object(r.b)(this,void 0,void 0,(function(){var s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,Object(o.a)(window.t("Reverse {positionId} position?").format({positionId:t}),window.t("Are you sure you want to reverse {positionId} position?").format({positionId:t})+(n?" "+window.t("This will also close all active orders."):""),window.t("Reverse position"),window.t("Cancel"))];case 1:if(!r.sent())return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,i()];case 3:return[2,r.sent()];case 4:return s=r.sent(),e(window.t("Failed to reverse position"),function(t){var e="";null!==t&&"object"==typeof t&&t.message?e=t.message:"string"==typeof t&&(e=t);return e}(s)),[2,!1];case 5:return[3,7];case 6:return[2,!1];case 7:return[2]}}))}))}},E9hm:function(t,e,i){"use strict";i.d(e,"b",(function(){return r
})),i.d(e,"a",(function(){return o}));var r={isSuspended:!1,supportDemoLiveSwitcher:!0,supportEditAmount:!0,supportMarketBrackets:!0,supportMarketOrders:!0,supportStopOrders:!0,supportLimitOrders:!0,supportStopLimitOrders:!1,supportPositions:!0,supportDOM:!0,supportModifyOrder:!0,supportModifyTrailingStop:!0,supportAddBracketsToExistingOrder:!0,supportVerifyLiveAccount:!0,supportReversePosition:!0,showNotificationsLog:!0,supportTwoFactorAuthorization:!1,supportDisplayBrokerNameInSymbolSearch:!0};function o(t){return Object.assign({},r,t)}},EOiv:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("fBig"),o=function(){function t(t,e){void 0===e&&(e={}),this._loadingEl=null,this._parentEl=t,this._options=e,this._renderLoading()}return t.prototype.toggleVisibility=function(t){null!==this._loadingEl&&this._loadingEl.classList.toggle(r.shown,t)},t.prototype._renderLoading=function(){this._loadingEl=document.createElement("span"),this._loadingEl.classList.add(r.loader),this._options.className&&this._loadingEl.classList.add(this._options.className),this._loadingEl.innerHTML='\n\t\t\t<span class="'+r.loaderItem+'"></span>\n\t\t\t<span class="'+r.loaderItem+'"></span>\n\t\t\t<span class="'+r.loaderItem+'"></span>\n\t\t',this._parentEl.appendChild(this._loadingEl)},t}()},End0:function(t,e,i){"use strict";i.r(e);var r=i("mrSG"),o=(i("P5fv"),i("bSeV"),i("YFKU")),n=i("Eyy1"),s=i("ivNn"),a=i("Hgre"),c=i("OekH"),u=i("8wgr"),l=i("U/Is"),d=i("aIyQ"),h=i.n(d),p=i("txPx"),b=i("d13A"),_=Object(p.getLogger)("Trading.RealtimeProvider"),f=function(){function t(t){this._results={},this._getter=t}return t.prototype.get=function(t){return this._results[t]||(this._results[t]=this._getter(t)),this._results[t]},t}(),y=function(){function t(t,e,i,r,o){var n=this;this._stopped=!1,this._subscribed=!1,this._provider=null,this._formatters=null,this._symbol=t,this._type=o,this._callback=e,this._providersCache=i,this._formattersCache=r,"Realtime"===this._type?this._handler=function(t,i){n._stopped||e(t,i,n._formatters)}:this._handler=function(t,i){n._stopped||e(t,i)},this._start().catch((function(t){}))}return t.prototype.symbol=function(){return this._symbol},t.prototype.type=function(){return this._type},t.prototype.callback=function(){return this._callback},t.prototype.destroy=function(){this._ensureNotStopped(),this._subscribed&&("Realtime"===this._type?Object(n.ensureNotNull)(this._provider).unsubscribeRealtime(this._symbol,this._handler):Object(n.ensureNotNull)(this._provider).unsubscribeDOME(this._symbol,this._handler)),this._stopped=!0},t.prototype._start=function(){return Object(r.b)(this,void 0,void 0,(function(){var t,e;return Object(r.d)(this,(function(i){switch(i.label){case 0:return t=this,[4,this._providersCache.get(this._symbol)];case 1:return t._provider=i.sent(),this._ensureNotStopped(),e=this,[4,this._formattersCache.get(this._symbol)];case 2:return e._formatters=i.sent(),Object(n.ensure)(this._formatters),this._ensureNotStopped(),this._subscribed=!0,
"Realtime"===this._type?this._provider.subscribeRealtime(this._symbol,this._handler):this._provider.subscribeDOME(this._symbol,this._handler),[2]}}))}))},t.prototype._ensureNotStopped=function(){Object(n.assert)(!this._stopped,"Should not be stopped")},t}(),v=function(){function t(t,e,i,r){this.onStatusChanged=new h.a,this._subscriptions=[],this._currentBroker=null,this._activeBrokerGetter=t,this._suggestedQty=r,e.subscribe(this,this._connectionStatusChanged),i.subscribe(this,this._connectionStatusChanged),this._tvProvider=new l.a("RealtimeProvider"),this._connectionStatusChanged()}return t.prototype.isTradable=function(t){return this._tradableCache.get(t)},t.prototype.subscribeRealtime=function(t,e){this._subscriptions.some((function(i){return i.symbol()===t&&i.callback()===e&&"Realtime"===i.type()}))||this._subscriptions.push(new y(t,e,this._providersCache,this._formattersCache,"Realtime"))},t.prototype.unsubscribeRealtime=function(t,e){var i=this._subscriptions.findIndex((function(i){return i.symbol()===t&&i.callback()===e&&"Realtime"===i.type()}));-1!==i?(this._subscriptions[i].destroy(),this._subscriptions.splice(i,1)):_.logWarn("Subscription not found")},t.prototype.subscribeDOME=function(t,e){this._subscriptions.some((function(i){return i.symbol()===t&&i.callback()===e&&"Dome"===i.type()}))||this._subscriptions.push(new y(t,e,this._providersCache,this._formattersCache,"Dome"))},t.prototype.unsubscribeDOME=function(t,e){var i=this._subscriptions.findIndex((function(i){return i.symbol()===t&&i.callback()===e&&"Dome"===i.type()}));-1!==i?(this._subscriptions[i].destroy(),this._subscriptions.splice(i,1)):_.logWarn("Subscription not found")},t.prototype.formatter=function(t){return this._formattersCache.get(t).then((function(t){return t.formatter}))},t.prototype.spreadFormatter=function(t){return this._formattersCache.get(t).then((function(t){return t.spreadFormatter}))},t.prototype.quantityFormatter=function(t){return this._formattersCache.get(t).then((function(t){return t.quantityFormatter}))},t.prototype.symbolInfo=function(t){var e=this;if(!t){var i={minTick:NaN,qty:{min:NaN,max:NaN,step:NaN},pipValue:NaN,pipSize:NaN,description:"no symbol"};return Promise.resolve(i)}return this._providersCache.get(t).then((function(i){return i!==e._tvProvider?i.symbolInfo(t).then((function(i){return i||e._tvProvider.symbolInfo(t)})).catch((function(i){return e._tvProvider.symbolInfo(t)})):e._tvProvider.symbolInfo(t)}))},t.prototype.quotesSnapshot=function(t){return this._providersCache.get(t).then((function(e){return e.quotesSnapshot(t)}))},t.prototype.activeBroker=function(){return null!==this._currentBroker&&this._currentBroker!==this._tvProvider?this._currentBroker:null},t.prototype._isTradable=function(t){if(null===this._currentBroker||this._currentBroker===this._tvProvider)return Promise.resolve({tradable:!1});try{return Object(b.a)(this._currentBroker.isTradable(t),6e4,"isTradable Promise Timeout").catch((function(){return Promise.resolve({tradable:!1})}))}catch(e){return Promise.resolve({tradable:!1})}},
t.prototype._haveRealtime=function(t){return this._tradableCache.get(t)||Promise.resolve(null===this._currentBroker)},t.prototype._connectionStatusChanged=function(){var t=this,e=this._activeBrokerGetter(),i=this._currentBroker,r=e&&1===e.connectionStatus()?e:null;if(this._createCaches(),i!==r){var o=this._subscriptions.map((function(t){return{symbol:t.symbol(),callback:t.callback(),type:t.type()}}));this._unsubscribeAll(),this._currentBroker=r,this._subscribeAll(o),this._allSymbols().forEach((function(e){t._suggestedQty.changed.fire(e)})),this.onStatusChanged.fire()}},t.prototype._allSymbols=function(){var t=new Set;return this._subscriptions.forEach((function(e){return t.add(e.symbol())})),Array.from(t)},t.prototype._createCaches=function(){var t=this;this._providersCache=new f((function(e){return t._provider(e)})),this._tradableCache=new f((function(e){return t._isTradable(e)})),this._formattersCache=new f((function(e){return t._providersCache.get(e).then((function(t){return Promise.all([t.formatter(e,!1),t.spreadFormatter(e),t.quantityFormatter(e)])})).then((function(t){return{formatter:t[0],spreadFormatter:t[1],quantityFormatter:t[2]}}))}))},t.prototype._provider=function(t){var e=this;return this._haveRealtime(t).then((function(t){return t.tradable&&e._currentBroker&&1===e._currentBroker.connectionStatus()?e._currentBroker:e._tvProvider}))},t.prototype._unsubscribeAll=function(){this._subscriptions.forEach((function(t){t.destroy()})),this._subscriptions=[]},t.prototype._subscribeAll=function(t){var e=this;t.forEach((function(t){e._subscriptions.push(new y(t.symbol,t.callback,e._providersCache,e._formattersCache,t.type))}))},t}(),m=i("2TBc"),g=function(t){function e(e){var i=t.call(this,e)||this;return i._userId=(window.user.id||"").toString(),window.loginStateChange&&window.loginStateChange.subscribe(i,i._onLoginStateChange),i}return Object(r.c)(e,t),e.prototype.trackOrderPlaced=function(t){this._trackOrderEvent("Placed",t)},e.prototype.startService=function(){Object(n.ensure)(this.activeBroker()).orderUpdate.subscribe(this,this._orderUpdate),this._trackTradingBrokerConnnected()},e.prototype.stopService=function(){Object(n.ensure)(this.activeBroker()).orderUpdate.unsubscribe(this,this._orderUpdate)},e.prototype._orderUpdate=function(t,e){e||(5===t.status?this._trackOrderEvent("Rejected",t):2===t.status?this._trackOrderEvent("Executed",t):1===t.status&&this._trackOrderEvent("Canceled",t))},e.prototype._trackOrderEvent=function(t,e){var i=this,r=this.activeBroker();e&&r&&r.symbolInfo(e.symbol).then((function(r){var o={amount:e.qty*(r.lotSize||1),instrumentType:r.type,eventName:"Order "+t,userId:i._userId};i._trackTradingOrder(o)}))},e.prototype._trackTradingOrder=function(t){var e=this.activeBroker();if(!e)throw new Error("no active broker")},e.prototype._trackTradingBrokerConnnected=function(){var t=this.activeBroker();null!==t&&t.metainfo().id;if(!t)throw new Error("no active broker")},e.prototype._onLoginStateChange=function(){this._userId=(window.user.id||"").toString()},e
}(m.a),k=i("Vdly"),O=i("4qhP"),w=i("9pog"),P=i("1AAW"),B=i("hY0g"),C=i.n(B),S=i("PT1i"),j=i("JWMC"),E=i("+xnd"),T=i("QloM");function D(t){switch(void 0===t&&(t="default"),t){case"danger":return E.a.Danger;case"attention":return E.a.Warning;case"success":return E.a.Success;default:return E.a.Default}}var N=function(){function t(t){this._chartWidgetCollection=t}return t.prototype.proSymbol=function(){return S.linking.proSymbol.value()},t.prototype.showTradingProperties=function(){this._chartWidgetCollection.activeChartWidget.value().showGeneralChartProperties(T.TabNames.trading)},t.prototype.showNotification=function(t,e,i,o){return Object(r.b)(this,void 0,void 0,(function(){var n,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this._chartWidgetCollection.getToasts()];case 1:return null===(n=r.sent())||(s="","string"==typeof e&&(s=e),n.showSimpleToast({text:s,time:o,title:t,intent:D(i)})),[2]}}))}))},t.prototype.showMaintenance=function(t){0},t.prototype.showBrokerSideMaintenance=function(t){0},t.prototype.trackEvent=function(t,e,i){Object(j.trackEvent)(t,e,i)},t.prototype.showReplayConfirmationDialog=function(){return Promise.resolve()},t.prototype.reconnectChartApi=function(t){0},t.prototype.setBroker=function(t){var e=(null==t?void 0:t.metainfo().backendBrokerName)||(null==t?void 0:t.metainfo().id.toLowerCase())||"";this._chartWidgetCollection.setBroker(e)},t}(),I=i("2uTr"),A=i("Kxc7"),L=i("8Wzo"),V=(i("HbRj"),i("5det"));function M(t,e,i){return Object(r.b)(this,void 0,void 0,(function(){var o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,Object(V.a)(window.t("Close position"),i,window.t("Close position"),window.t("Cancel"))];case 1:if(!r.sent())return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,e()];case 3:return[2,r.sent()];case 4:return o=r.sent(),t(window.t("Failed to close the position"),function(t){var e="";null!==t&&"object"==typeof t&&t.message?e=t.message:"string"==typeof t&&(e=t);return e}(o)),[2,!1];case 5:return[3,7];case 6:return[2,!1];case 7:return[2]}}))}))}var R=i("C9TK"),U=i("1rjR"),q=i("QBLL"),F=(i("5XxY"),i("q1tI")),x=i("9XXR");function W(t){var e=t.symbol,i=t.side,r=t.qty,n=t.price,s=t.id,a=t.closePositionCancelsOrders,c=Object(x.splitThousands)(r," "),u=Object(x.splitThousands)(n," ");return F.createElement(F.Fragment,null,F.createElement("div",null,void 0!==s?Object(o.t)("Position ID {id}").replace("{id}",s):Object(o.t)("Position")),F.createElement("div",null,F.createElement("b",null,e)),F.createElement("div",null,F.createElement("b",null,i+" "+c+" @ "+u)),F.createElement("div",null,a&&" "+Object(o.t)("This will also close all active orders")))}function Q(t,e,i){return Object(r.b)(this,void 0,void 0,(function(){var o,n,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,H(t)];case 1:if(!(o=r.sent()).status)return[3,6];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,e(o.qty)];case 3:return[2,r.sent()];case 4:return n=r.sent(),s=window.t("Failed to close the position"),i(s,function(t){var e=""
;null!==t&&"object"==typeof t&&t.message?e=t.message:"string"==typeof t&&(e=t);return e}(n)),[2,!1];case 5:return[3,7];case 6:return[2,!1];case 7:return[2]}}))}))}function H(t){return Object(r.b)(this,void 0,void 0,(function(){var e,o;return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([i.e("react"),i.e("partially-closing-dialog-renderer")]).then(i.bind(null,"+BC+"))];case 1:return e=n.sent().PartiallyClosingDialogRenderer,o=new e,[2,new Promise((function(e){o.open(Object(r.a)(Object(r.a)({},t),{dialogActionHandler:e}))}))]}}))}))}var z=Object(p.getLogger)("Trading.BrokerCommandsUI"),G={symbol:1,qty:1,side:1,type:1,seenPrice:1};var K=function(){function t(t,e,i,r,o,n){this._isClosePositionDialogLoading=!1,this._isCloseTradeDialogLoading=!1,this._activeBroker=t,this._guiAccessor=e,this._orderViewController=r,this._showErrorNotification=o,this._noConfirmEnabled=i,this._trackEvent=n}return t.prototype.placeOrder=function(t,e,i){var o;return Object(r.b)(this,void 0,void 0,(function(){var n,s,a,c,u,l=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:0,this._makeSureBrokerIsConnected(),n=e&&this._noConfirmEnabled.value(),s=this._guiAccessor&&n?this._guiAccessor.showReplayConfirmationDialog():Promise.resolve(!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s];case 2:return r.sent(),[3,4];case 3:return r.sent(),Promise.resolve(!1),[3,4];case 4:return[4,this._activeBroker.isTradable(t.symbol)];case 5:return a=r.sent(),n&&a.tradable&&function(t){for(var e in G)if(!(e in t))return!1;return!0}(t)?(c=this._activeBroker.metainfo().durations,void 0===t.duration&&void 0!==c&&c.length>0&&(t.duration=null!==(o=Object(O.k)(t.type,c))&&void 0!==o?o:{type:c[0].value}),[2,this._activeBroker.placeOrder(t)]):(u=this._activeBroker.metainfo()).customUI&&void 0!==u.customUI.showOrderDialog?[2,u.customUI.showOrderDialog(t)]:[2,this._orderViewController().then((function(e){return l._activeBroker?e.showOrderView(l._activeBroker,t,void 0,i):Promise.reject("Broker connection adapter is null")}))]}}))}))},t.prototype.modifyOrder=function(t,e,i,o){return Object(r.b)(this,void 0,void 0,(function(){var n,s,a,c,u,l,d,h,p,b,_,f=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return this._makeSureBrokerIsConnected(),t.flags&&t.flags.trailingStop?(z.logError("Attempt to modify trailing stop loss order"+t.id),this._showErrorNotification(window.t("Cannot Modify Order"),window.t("Trailing Stops cannot be modified")),[2,Promise.resolve(!1)]):[4,this._activeBroker.symbolInfo(t.symbol)];case 1:if(n=r.sent(),t.limitPrice=void 0!==n.limitPriceStep&&void 0!==t.limitPrice?Object(O.x)(t.limitPrice,n.limitPriceStep,1,t.side):t.limitPrice,t.stopPrice=void 0!==n.stopPriceStep&&void 0!==t.stopPrice?Object(O.x)(t.stopPrice,n.stopPriceStep,2,t.side):t.stopPrice,s=t.limitPrice,a=t.stopPrice,c=t.stopType,u=e&&this._noConfirmEnabled.value(),l=i||(1===t.type?1:2),!t.parentId||A.enabled("always_pass_called_order_to_modify"))return[3,6];d=this._activeBroker.orderById.bind(this._activeBroker),
2===t.parentType&&(d=this._activeBroker.positionById.bind(this._activeBroker)),3===t.parentType&&(d=this._activeBroker.tradeById.bind(this._activeBroker)),h=void 0,r.label=2;case 2:return r.trys.push([2,4,,5]),[4,d(t.parentId)];case 3:return h=r.sent(),[3,5];case 4:return r.sent(),h=void 0,[3,5];case 5:if(h){if(l=i||(1===t.type?3:4),p={takeProfit:s},c===L.a.TrailingStop?p.trailingStopPips=t.trailingStopPips:p.stopLoss=a,u&&(p.takeProfit=p.takeProfit||h.takeProfit,p.stopLoss=p.stopLoss||h.stopLoss,p.trailingStopPips=p.trailingStopPips||h.trailingStopPips),3===t.parentType)return u?[2,this._activeBroker.editTradeBrackets(h.id,p)]:[2,this._showTradeDialog(h,p,l)];if(2===t.parentType&&t.qty===Math.abs(h.qty))return u?[2,this._activeBroker.editPositionBrackets(h.id,p)]:[2,this._showPositionDialog(h,p,l)];b=h,Object(O.n)(b.status)&&(t=Object.assign({},b),s&&(t.takeProfit=s),a&&(c===L.a.TrailingStop?t.trailingStopPips=p.trailingStopPips||t.trailingStopPips:t.stopLoss=a))}r.label=6;case 6:return u?[2,this._activeBroker.modifyOrder(t)]:(_=this._activeBroker.metainfo()).customUI&&void 0!==_.customUI.showOrderDialog?[2,_.customUI.showOrderDialog(t,l)]:[2,this._orderViewController().then((function(e){return f._activeBroker?e.showOrderView(f._activeBroker,t,l,o):Promise.reject("Broker connection adapter is null")}))]}}))}))},t.prototype.closePosition=function(t){return Object(r.b)(this,void 0,void 0,(function(){var e,i,o,n,s,a=this;return Object(r.d)(this,(function(c){switch(c.label){case 0:return this._makeSureBrokerIsConnected(),this._noConfirmEnabled.value()?[2,this._activeBroker.closePosition(t)]:[3,1];case 1:return this._isClosePositionDialogLoading?[2,!1]:[4,this._obtainPositionClosingData(t)];case 2:return void 0===(e=c.sent())?[2,!1]:(i=e.supportPartialClosePosition,o=e.position,n=Object(r.e)(e,["supportPartialClosePosition","position"]),i?(s=function(i){return i!==e.position.qty?a._trackEvent("","Close Position Dialog","partial"):a._trackEvent("","Close Position Dialog","full"),a._activeBroker.closePosition(t,i)},[2,Q(Object(r.a)(Object(r.a)({},n),{positionOrTrade:o}),s,this._showErrorNotification)]):(s=function(){return a._activeBroker.closePosition(t)},[2,M(this._showErrorNotification,s,e.message)]));case 3:return[2]}}))}))},t.prototype.closeTrade=function(t){return Object(r.b)(this,void 0,void 0,(function(){var e,i,o,s,a,c=this;return Object(r.d)(this,(function(u){switch(u.label){case 0:return this._makeSureBrokerIsConnected(),Object(n.assert)(!!this._activeBroker.config.supportTrades,"Broker doesn`t support trades"),this._noConfirmEnabled.value()?[2,this._activeBroker.closeTrade(t)]:[3,1];case 1:return this._isCloseTradeDialogLoading?[2,!1]:[4,this._obtainTradeClosingData(t)];case 2:return void 0===(e=u.sent())?[2,!1]:(i=e.supportPartialCloseTrade,o=e.trade,s=Object(r.e)(e,["supportPartialCloseTrade","trade"]),i?(a=function(e){return Object(r.b)(c,void 0,void 0,(function(){return Object(r.d)(this,(function(i){
return e!==o.qty?this._trackEvent("","Close Trade Dialog","partial"):this._trackEvent("","Close Trade Dialog","full"),[2,this._activeBroker.closeTrade(t,e)]}))}))},[2,Q(Object(r.a)(Object(r.a)({},s),{positionOrTrade:o}),a,this._showErrorNotification)]):(a=function(){return c._activeBroker.closeTrade(t)},[2,M(this._showErrorNotification,a,e.message)]));case 3:return[2]}}))}))},t.prototype.editPositionBrackets=function(t,e,i,r){var o=this;return this._makeSureBrokerIsConnected(),Object(n.assert)(!!this._activeBroker.config.supportPositionBrackets,"Broker doesn`t support brackets on positions"),r?Object(n.ensureDefined)(this._activeBroker.editPositionBrackets)(t,e):this._activeBroker.positionById(t).then((function(t){return o._activeBroker?o._showPositionDialog(Object(n.ensureDefined)(t),e,i):Promise.reject("Broker connection adapter is null")}))},t.prototype.editTradeBrackets=function(t,e,i,r){var o=this;return void 0===e&&(e={}),r&&this._noConfirmEnabled.value()?this._activeBroker.editTradeBrackets(t):this._activeBroker.tradeById(t).then((function(t){if(!o._activeBroker)return Promise.reject("Broker connection adapter is null");var r=Object(n.ensureDefined)(t);return o._showTradeDialog(r,e,i)}))},t.prototype.reversePosition=function(t){var e=this;return this._makeSureBrokerIsConnected(),this._activeBroker.metainfo().configFlags.supportMultiposition&&!this._activeBroker.config.supportNativeReversePosition?Promise.reject("Cannot reverse position on multiposition acount"):this._noConfirmEnabled.value()?this._activeBroker.reversePosition(t):this._activeBroker.positionById(t).then((function(i){if(!e._activeBroker)return Promise.reject("Broker connection adapter is null");var r=e._activeBroker.reversePosition.bind(e._activeBroker,t);return Object(R.a)(t,e._showErrorNotification,r,e._activeBroker.config.closePositionCancelsOrders)}))},t.prototype.cancelOrder=function(t){return Object(r.b)(this,void 0,void 0,(function(){var e,i,o,n,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return this._makeSureBrokerIsConnected(),this._noConfirmEnabled.value()?[2,this._activeBroker.cancelOrder(t)]:[3,1];case 1:return[4,this._activeBroker.orderById(t)];case 2:return e=r.sent(),i=this._activeBroker.cancelOrder.bind(this._activeBroker,t),e?(o=e.refNumber||e.referenceNumber||e.id,e.parentId?2!==e.parentType?[3,4]:[4,this._activeBroker.orders()]:[3,5]):[3,6];case 3:return n=r.sent(),s=n.filter((function(t){return t.refNumber===e.refNumber})),this._activeBroker.metainfo().configFlags.cancellingOnePositionBracketsCancelsOther&&s.length>1?[2,this._showCancelMultipleBracketsDialog(o,i)]:[2,this._showCancelBracketsDialog(o,i)];case 4:if(!this._activeBroker.metainfo().configFlags.cancellingBracketCancelsParentOrder)return[2,this._showCancelBracketsDialog(o,i)];r.label=5;case 5:return[2,this._showCancelOrderDialog(o,i)];case 6:return[2,Promise.reject("Failed to find order")]}}))}))},t.prototype.cancelOrders=function(t,e){var i=this;return this._makeSureBrokerIsConnected(),this._activeBroker.orders().then((function(r){
if(!i._activeBroker)return Promise.reject("Broker connection adapter is null");var o=r.filter((function(i){return i.symbol===t&&(!e||i.side===e)&&function(t){return 4===t.status||3===t.status||6===t.status}(i)}));if(!o.length)return Promise.resolve(!1);if(1===o.length)return i.cancelOrder(o[0].id);var n=o.map((function(t){return t.id}));if(i._noConfirmEnabled.value())return i._activeBroker.cancelOrders(t,e,n);var s=i._activeBroker.cancelOrders.bind(i._activeBroker);return i._showCancelMultipleOrdersDialog(t,e,n,s)}))},t.prototype._makeSureBrokerIsConnected=function(){Object(n.assert)(1===this._activeBroker.connectionStatus(),"Broker is not connected")},t.prototype._showPositionDialog=function(t,e,i){return void 0===e&&(e={}),Object(r.b)(this,void 0,void 0,(function(){var o,n,s,a=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this._activeBroker.isTradable(t.symbol)];case 1:return(o=r.sent()).tradable?(s=this._activeBroker.metainfo()).customUI&&void 0!==s.customUI.showPositionDialog?[2,s.customUI.showPositionDialog(t,{stopLoss:e.stopLoss||t.stopLoss,takeProfit:e.takeProfit||t.takeProfit},i)]:[2,this._orderViewController().then((function(r){return a._activeBroker?r.showPositionView(a._activeBroker,t,{stopLoss:e.stopLoss,takeProfit:e.takeProfit,trailingStopPips:e.trailingStopPips},i||t.limitPrice&&3||t.stopPrice&&4):Promise.reject("Broker connection adapter is null")}))]:(n=void 0!==o.reason?o.reason:window.t("Symbol {symbol} cannot be traded through {broker}.").format({symbol:t.symbol,broker:this._activeBroker.metainfo().title}),this._showErrorNotification(window.t("Cannot protect position"),n),[2,Promise.resolve(!1)])}}))}))},t.prototype._showTradeDialog=function(t,e,i){var r=this;void 0===e&&(e={});var o=this._activeBroker.metainfo();return o.customUI&&void 0!==o.customUI.showPositionDialog?o.customUI.showPositionDialog(t,{stopLoss:e.stopLoss||t.stopLoss,takeProfit:e.takeProfit||t.takeProfit},i):this._orderViewController().then((function(o){return r._activeBroker?o.showTradeView(r._activeBroker,t,{stopLoss:e.stopLoss,takeProfit:e.takeProfit,trailingStopPips:e.trailingStopPips},i||t.limitPrice&&3||t.stopPrice&&4):Promise.reject("Broker connection adapter is null")}))},t.prototype._isMaintenance=function(){return isFeatureEnabled(Object(O.r)(this._activeBroker.metainfo().id))},t.prototype._isBrokerSideMaintenance=function(){return isFeatureEnabled(Object(O.q)(this._activeBroker.metainfo().id))},t.prototype._showCancelOrderDialog=function(t,e){return U.a.get().open(t).then((function(i){return i?e(t):Promise.resolve(!1)}))},t.prototype._showCancelMultipleOrdersDialog=function(t,e,i,r){var o=i.length;return U.a.get().multiple(t,e,o).then((function(o){return o?r(t,e,i):Promise.resolve(!1)}))},t.prototype._showCancelBracketsDialog=function(t,e){return q.a.get().open(t).then((function(i){return i?e(t):Promise.resolve(!1)}))},t.prototype._showCancelMultipleBracketsDialog=function(t,e){return q.a.get().multiple(t).then((function(i){return i?e(t):Promise.resolve(!1)}))},
t.prototype._obtainPositionClosingData=function(t){return Object(r.b)(this,void 0,void 0,(function(){var e,i,o,s,a,c,u,l,d,h;return Object(r.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),this._isClosePositionDialogLoading=!0,i=n.ensureDefined,[4,this._activeBroker.positionById(t)];case 1:return e=i.apply(void 0,[r.sent()]),[4,this._obtainPositionOrTradeClosingCommonData(e)];case 2:return o=r.sent(),s=o.supportLots,a=o.qtyStep,c=o.minQty,u=o.qtyFormatter,l=o.priceFormatter,d=this._activeBroker.metainfo().configFlags.supportPartialClosePosition,h=W({symbol:e.symbol,side:1===e.side?window.t("Long"):window.t("Short"),qty:u.format(e.qty),price:l.format(e.avgPrice),closePositionCancelsOrders:this._activeBroker.config.closePositionCancelsOrders}),this._isClosePositionDialogLoading=!1,[2,{position:e,supportLots:s,qtyStep:a,minQty:c,supportPartialClosePosition:d,qtyFormatter:u,message:h}];case 3:return r.sent(),this._isClosePositionDialogLoading=!1,[2];case 4:return[2]}}))}))},t.prototype._obtainTradeClosingData=function(t){return Object(r.b)(this,void 0,void 0,(function(){var e,i,o,s,a,c,u,l,d,h;return Object(r.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),this._isCloseTradeDialogLoading=!0,i=n.ensureDefined,[4,this._activeBroker.tradeById(t)];case 1:return e=i.apply(void 0,[r.sent()]),[4,this._obtainPositionOrTradeClosingCommonData(e)];case 2:return o=r.sent(),s=o.supportLots,a=o.qtyStep,c=o.minQty,u=o.qtyFormatter,l=o.priceFormatter,d=this._activeBroker.metainfo().configFlags.supportPartialCloseTrade,h=W({symbol:e.symbol,side:1===e.side?window.t("Long"):window.t("Short"),qty:u.format(e.qty),price:l.format(e.price),id:t,closePositionCancelsOrders:this._activeBroker.config.closePositionCancelsOrders}),this._isCloseTradeDialogLoading=!1,[2,{trade:e,supportLots:s,qtyStep:a,minQty:c,supportPartialCloseTrade:d,qtyFormatter:u,message:h}];case 3:return r.sent(),this._isCloseTradeDialogLoading=!1,[2];case 4:return[2]}}))}))},t.prototype._obtainPositionOrTradeClosingCommonData=function(t){return Object(r.b)(this,void 0,void 0,(function(){var e,i,o,n,s,a;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this._activeBroker.symbolInfo(t.symbol)];case 1:return e=r.sent(),i=void 0!==e.lotSize,o=e.qty.step,n=e.qty.min,[4,this._activeBroker.quantityFormatter(t.symbol)];case 2:return s=r.sent(),[4,this._activeBroker.formatter(t.symbol,!1)];case 3:return a=r.sent(),[2,{supportLots:i,qtyStep:o,minQty:n,qtyFormatter:s,priceFormatter:a}]}}))}))},t}(),J=i("N22A"),Y=function(){function t(t,e){var i=this;this._domePanel=null,this._resizerBridge=t,this._close=function(){i.unmount(),e()}}return t.prototype.mount=function(){return this._getDomPanel().then((function(t){t.setVisibility(!0)}))},t.prototype.unmount=function(){this._getDomPanel().then((function(t){t.setVisibility(!1)}))},t.prototype._getDomPanel=function(){return Object(r.b)(this,void 0,void 0,(function(){var t,e,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:
return null!==this._domePanel?[2,Promise.resolve(this._domePanel)]:[4,Promise.all([i.e("react"),i.e(1),i.e(3),i.e(5),i.e(13),i.e(14),i.e(19),i.e(22),i.e(23),i.e(27),i.e(39),i.e(48),i.e(56),i.e(63),i.e(101),i.e(102),i.e(113),i.e(0),i.e(2),i.e(8),i.e(18),i.e(21),i.e(26),i.e(51),i.e(54),i.e(80),i.e("dome-panel")]).then(i.bind(null,"nr7h"))];case 1:return t=r.sent(),[4,Object(J.waitTradingService)()];case 2:return e=r.sent(),(o=new t.DomePanel(e,this._resizerBridge)).setCloseHandler(this._close),this._domePanel=o,[2,o]}}))}))},t}(),X=function(){function t(){}return t.prototype.mount=function(){return Promise.resolve()},t.prototype.unmount=function(){},t}(),Z=i("vOQ2"),tt=i("/BH3"),et=i("6aj4"),it=A.enabled("show_order_panel_on_start"),rt=function(){function t(t){var e=this;this.isOpened=new C.a(!1),this.isAvailable=new C.a(!0),this.activePage=new C.a(it?Z.d.OrderPanel:Z.d.DomPanel),this.isLoading=new C.a(!1),this._pages={},this._width=Z.c,this._onLayoutResizeHandleMousedown=function(t){if(!t.defaultPrevented&&t.cancelable){t.preventDefault();var i,r=Math.max(e._resizerBridge.width.value(),0);i="touches"in t?t.touches[0].clientX:t.clientX;var o=function(t){var o;t.preventDefault(),o="touches"in t?t.touches[0].clientX:t.clientX;var n=r-(o-i);n<Z.c?n=Z.c:n>Z.a&&(n=Z.a),e._requestWidth(n)},n=function(){document.removeEventListener("mousemove",o),document.removeEventListener("touchmove",o),document.removeEventListener("mouseup",n),document.removeEventListener("touchend",n),k.setValue(u.a.PANEL_WIDTH,e._width)};document.addEventListener("mousemove",o),document.addEventListener("touchmove",o,{passive:!1}),document.addEventListener("mouseup",n),document.addEventListener("touchend",n,{passive:!1})}},this._resizerBridge=t,this._rootContainer=this._resizerBridge.container.value(),this.container=document.createElement("div"),this.container.classList.add(et["trading-panel-content"],"trading-panel-content"),this._rootContainer.appendChild(this.container),this._addSpinner(),this._addResizeHandler(),this._updateAvailable({width:this._resizerBridge.availWidth.value(),height:this._resizerBridge.availHeight.value()}),Object(P.combine)((function(t,e){return{width:t,height:e}}),this._resizerBridge.availWidth,this._resizerBridge.availHeight).subscribe(this._updateAvailable.bind(this)),this.isLoading.subscribe(this._setLoading.bind(this)),this._rootContainer.style.overflow=this.isOpened.value()?"":"hidden"}return t.prototype.addPage=function(t,e){this._pages[t]=e},t.prototype.isPageOpened=function(t){return this.isOpened.value()&&this.activePage.value()===t},t.prototype.setPage=function(t){this.isOpened.value()&&this.activePage.value()!==t&&this._pages[this.activePage.value()]&&this._pages[this.activePage.value()].unmount(),this.activePage.setValue(t),k.setValue(u.a.TRADING_PANEL_ACTIVE_PAGE,t)},t.prototype.openPage=function(t){this.setPage(t),this.open()},t.prototype.open=function(){this._pages[this.activePage.value()]&&(this._togglePanel(!0),this.isOpened.setValue(!0),this._pages[this.activePage.value()].mount())},
t.prototype.close=function(){this.isOpened.setValue(!1),this._pages[this.activePage.value()]&&this._pages[this.activePage.value()].unmount(),this._togglePanel(!1)},t.prototype._setLoading=function(t){t?this._rootContainer.appendChild(this._spinnerContainer):this._rootContainer.contains(this._spinnerContainer)&&this._rootContainer.removeChild(this._spinnerContainer)},t.prototype._addSpinner=function(){var t=this;this._spinnerContainer=document.createElement("div"),this._spinnerContainer.classList.add(et["trading-panel-spinner"]),Promise.all([i.e("react"),i.e("spinner-renderer")]).then(i.bind(null,"lG9f")).then((function(e){e.render(t._spinnerContainer)}))},t.prototype._addResizeHandler=function(){this._handle=document.createElement("div"),this._handle.classList.add(et["trading-panel-handle"]),this._rootContainer.appendChild(this._handle),this._handle.addEventListener("mousedown",this._onLayoutResizeHandleMousedown,{passive:!1}),this._handle.addEventListener("touchstart",this._onLayoutResizeHandleMousedown,{passive:!1}),this._width=k.getInt(u.a.PANEL_WIDTH)||Z.c},t.prototype._togglePanel=function(t){this._resizerBridge.negotiateWidth(t?this._width:0),this._resizerBridge.negotiateHeight(t?Z.b:0),this._rootContainer.style.overflow=t?"":"hidden",k.setValue(u.a.TRADING_PANEL_OPENED,t)},t.prototype._updateAvailable=function(t){this.isAvailable.setValue(t.width>=Z.c&&t.height>=Z.b)},t.prototype._requestWidth=function(t){this._canOpen(t)&&this._resizerBridge.width.value()!==t&&(this._resizerBridge.negotiateWidth([{min:Z.c,max:t}]),this._width=t)},t.prototype._canOpen=function(t){return t+tt.tabsWidth<=this._resizerBridge.availWidth.value()},t}(),ot=i("lxNp"),nt=i("dOnf"),st=i("mNbo"),at=i("+J+G"),ct=Object(p.getLogger)("Lib.Sound",{color:"#dea433"}),ut="notification/notification",lt=[{title:window.t("Alarm Clock"),path:"alert/alarm_clock",soundForAlerts:!0,filePath:at}];var dt={};function ht(){pt(lt.filter((function(t){return!!t.soundForAlerts})).map((function(t){return t.path})))}function pt(t){if(!Object(st.a)("any")&&(t&&/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(window.navigator.userAgent)))if(Array.isArray(t)||(t=[t]),0!==(t=t.filter((function(t){var e=bt(t);return!(!e||!e.el.load||e._mobilePreloadActive)&&(e._mobilePreloadActive=!0,!0)}))).length){var e=function(){var r=[];Array.isArray(t)&&t.forEach((function(t){var e=bt(t);e.el.load();var i=e.play().catch((function(t){if("AbortError"!==t.name)throw ct.logError('enableForMobile for "'+e.el.src+'" preload error: - '+t.message),t}));e.el.pause(),r.push(i)})),Promise.all(r).then((function(){ct.logNormal("enableForMobile sounds initialized")})),i.forEach((function(t){document.removeEventListener(t,e,!0)}))},i=["click","touchend","keydown"];i.forEach((function(t){document.addEventListener(t,e,!0)}))}else ct.logNormal("enableForMobile no sounds passed")}var bt=function(t){if(t in dt)return dt[t];ct.logNormal("requested sound  "+t+" not cached, building a new audio element");var e=lt.find((function(e){return e.path===t}))
;if(void 0===e)throw new Error('Cannot find sound "'+t+'"');var i=new Audio(e.filePath),r={el:i,playing:new C.a(!1),play:function(e){return void 0===e&&(e=0),r.playing.value()?(ct.logNormal("sound already playing"),Promise.reject("already playing")):(r.playing.setValue(!0),new Promise((function(i,o){var n=e>0,s=function(){(function(t){try{ct.logNormal('"'+t.el.src+'" triggering html5 play method, readyState - '+t.el.readyState+"; muted - "+t.el.muted+"; volume - "+t.el.volume+"; currentTime - "+t.el.currentTime);var e=t.el.play();return e||(e=Promise.resolve()),e}catch(i){return ct.logError('play method for "'+t.el.src+'" catch error - '+i.message),Promise.reject(i)}})(r).catch((function(e){ct.logNormal('stop counting sound "'+t+'"; as playing due to an error: '+e.message),r.stop(),o(e)}))};r._onEnded=function(){n?s():(r.stop(),i())},r.el.addEventListener("ended",r._onEnded),n&&setTimeout((function(){ct.logNormal('"'+t+'" repeat timeout - '+e+"s off"),n=!1}),1e3*e),s()})))},stop:function(){r.el.pause(),r.playing.setValue(!1),r._onEnded&&r.el.removeEventListener("ended",r._onEnded)}};dt[t]=r;return["canplaythrough","error"].forEach((function(e){i.addEventListener(e,(function(){ct.logNormal('for sound "'+t+'", event - '+e+" is fired")}),!1)})),ct.logNormal("canPlayType - "+i.canPlayType("audio/mp3")),dt[t]};pt(lt.filter((function(t){return!!t.common})).map((function(t){return t.path})));var _t=i("JOqt"),ft=i("IWXC"),yt=["qty","stopPrice","limitPrice","filledQty","status"];function vt(t,e){return t.enabled.value()&&(e.soundName=t.name),e}function mt(t){return 6===t||3===t}var gt=function(t){function e(e){var i=t.call(this,e)||this;return i._orders=[],i._playSound=Object(_t.debounce)(i._playSoundImpl,50),ht(),i}return Object(r.c)(e,t),e.prototype.startService=function(){var t=this,e=Object(n.ensure)(this.activeBroker());e.orders().then((function(e){return t._orders=Object(nt.deepCopy)(e)})),e.orderUpdate.subscribe(this,this._orderUpdate)},e.prototype.stopService=function(){Object(n.ensure)(this.activeBroker()).orderUpdate.unsubscribe(this,this._orderUpdate)},e.prototype._showNotification=function(t,e,i){A.enabled("trading_notifications")&&("error"===i?this.trading().showErrorNotification(t,e):this.trading().showSuccessNotification(t,e))},e.prototype._formatter=function(t){return Object(ft.getQuoteSessionInstance)("simple").formatter(t)},e.prototype._checkOrderModified=function(t,e){var i=this.activeBroker(),r=i&&i.metainfo().customNotificationFields||[],o=yt.concat(r),n=!1;return o.forEach((function(i){n||function t(e,i,r){if(void 0===e||void 0===i)return!1;var o=r.indexOf(".");if(-1!==o){var n=r.substring(0,o);return t(e[n],i[n],r.substring(o+1))}return e[r]===i[r]}(t,e,i)||(n=!0)})),n},e.prototype._generateNotificationsInfo=function(t,e){var i=[],r=t.statusMessage?": "+t.statusMessage:"",o=(1===t.side?window.t("Bought"):window.t("Sold")).toUpperCase(),n=this.trading().orderExecutedSoundParams;return e?(this._checkOrderModified(t,e)&&(1===t.status?i.push({text:window.t("cancelled")}):5===t.status?i.push({
text:window.t("rejected")+r,type:"error"}):6===t.status&&e.filledQty!==t.filledQty?i.push(vt(n,{side:o,text:window.t("executed partially")})):mt(t.status)?i.push({text:window.t("modified")}):2===t.status&&i.push(vt(n,{side:o,text:window.t("executed")}))),Object.assign(e,t)):mt(t.status)?(this._orders.push(t),i.push({text:window.t("placed")}),this.trading().trackEvent("","Order placed symbol",t.symbol)):1===t.status?i.push({text:window.t("cancelled")}):5===t.status?(this._orders.push(t),i.push({text:window.t("rejected")+r,type:"error"})):2===t.status&&(this._orders.push(t),i.push({text:window.t("placed")},vt(n,{side:o,text:window.t("executed"),emptyOrderType:!0})),this.trading().trackEvent("","Order placed symbol",t.symbol)),i},e.prototype._orderUpdate=function(t,e){var i=this,r=Object(nt.deepCopy)(t),o=this._orders.find((function(t){return t.id===r.id}));if(e)void 0===o&&this._orders.push(r);else if(!o||!O.l(o.status)){var n=this._generateNotificationsInfo(r,o);0!==n.length&&this._formatter(r.symbol).then((function(t){var e=O.y(r.side,!0),o="",s="",a=r.qty;switch(r.type){case 2:o=r.avgPrice?" ("+O.w(r.type)+")":"",s=r.avgPrice?t.format(r.avgPrice):O.w(r.type);break;case 4:o=" "+window.t("(Limit) after {0} (Stop) crossed").format(t.format(r.stopPrice)),s=t.format(r.avgPrice||r.limitPrice);break;default:o=" ("+O.w(r.type)+")",s=t.format(r.avgPrice||r.limitPrice||r.stopPrice)}r.hasOwnProperty("filledQty")&&void 0!==r.filledQty&&r.filledQty>0&&(a=r.filledQty);var c=Object(x.splitThousands)(Math.abs(a),"Â ")+" "+(r.brokerSymbol||r.symbol)+" "+window.t("at")+" "+s,u=void 0!==r.message?""+r.message.text.charAt(0).toUpperCase()+r.message.text.substr(1):"";n.forEach((function(t){var n=t.side,s=t.text,a=t.type,l=t.emptyOrderType,d=t.soundName,h=window.t("Order")+" "+r.id+" "+s,p=(n||e)+" "+c+" "+(l?"":o)+"\n"+u;void 0!==d&&i._playSound(d),i._showNotification(h,p,a)}))}))}},e.prototype._playSoundImpl=function(t){var e,i,r=this;if(this._playingSound){if(this._playingSound===t)return;!function(t){if(!Object(st.a)("any")){var e=[];t?e.push(bt(t)):e=Object.values(dt),e.forEach((function(t){t.stop()}))}}(this._playingSound)}this._playingSound=t,void 0===(e=t)&&(e=ut),Object(st.a)("any")?Promise.resolve():(ct.logNormal('Sound play attempt for "'+e+'" duration-'+i+"s;"),bt(e).play(i)),function(t,e){Object(st.a)("any")||bt(t).playing.subscribe((function(t){t||e()}),{once:!0})}(t,(function(){delete r._playingSound}))},e}(m.a),kt=i("fZEr"),Ot=i("pPtI"),wt=0;var Pt=function(){function t(t,e,i,r,o){this._currentPointsetId=null,this._onUpdate=new h.a,this._requestPoints=[],this._gateway=t,this._pointsetSuffix=e,this._isGatewayConnected=this._gateway.isConnected().spawn(),this._isGatewayConnected.subscribe(this._updateByGatewayConnection.bind(this)),this._addPoints(i,r,o)}return t.prototype.onUpdate=function(){return this._onUpdate},t.prototype.destroy=function(){this._isGatewayConnected.value()&&null!==this._currentPointsetId&&this._gateway.removePointset(this._currentPointsetId),this._requestPoints=[],this._currentPointsetId=null,
this._isGatewayConnected.destroy()},t.prototype._updateByGatewayConnection=function(t){t||(this._currentPointsetId=null,this._requestPoints=[])},t.prototype._addPoints=function(t,e,i){var r,o;this._isGatewayConnected.value()&&(Object(n.assert)(t.length>0,"Can't possible create point set for empty array of time points"),this._requestPoints=t.map((function(t){return[t.time_t,t.offset]})),this._currentPointsetId=(r=this._pointsetSuffix,o=++wt,"pointset_"+r+"_"+o),this._gateway.createPointset(this._currentPointsetId,"turnaround",e,Object(Ot.getServerInterval)(i),this._requestPoints,this._dataUpdate.bind(this)))},t.prototype._dataUpdate=function(t){for(var e=[],i=0,r=t.params.plots;i<r.length;i++){var o=r[i];e.push({time_t:this._requestPoints[o.index][0],index:o.value[0],barTime:o.value[1]})}this._onUpdate.fire(e)},t}(),Bt=i("GOhO");function Ct(t){var e=t.mainSeries().data().first();return null===e?null:e.value[0]}function St(t,e){return Object(r.b)(this,void 0,void 0,(function(){var o,n,s,a;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,Promise.all([i.e("trading-custom-sources").then(i.bind(null,"fA+p")),i.e("trading-custom-sources").then(i.bind(null,"KSBC")),i.e("trading-custom-sources").then(i.bind(null,"EgV8"))])];case 1:return o=r.sent(),n=o[0],s=o[1],a=o[2],t.addCustomSource("executions",(function(t,i){var r=i.mainSeries(),o=r.dataEvents(),c=Object(Bt.b)(i.isInReplay.bind(i),i.onInReplayStateChanged()),u=Object(Bt.b)(r.isConvertedToOtherCurrency.bind(r),r.symbolResolved()),l=Object(Bt.a)((function(t,e,i){return i&&!e}),c,u,i.properties().tradingProperties.showExecutions),d=function(t,e,i){return function(r){var o=i.symbolId(),n=i.interval();return null===o?null:new Pt(t,e,r,o,n)}}(i.chartApi(),"executions",r),h=Object(Bt.c)(Ct.bind(null,i),o.barReceived()),p=new n.ExecutionsService(e,o,function(t){return function(){var e=t.symbolInfo();return null!==e?e.pro_name||e.full_name:t.proSymbol()}}(r)),b=new s.ExecutionsPointsManager(p,d,h);return new a.ExecutionsSource(t,i,e,l,b)})),[2]}}))}))}var jt=i("ogJP"),Et=Object(p.getLogger)("Trading.Positions");function Tt(t){var e=null===t?0:Math.round(100*t)/100;return e>0?"positive":e<0?"negative":"neutral"}var Dt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._positions=new Map,e._positionUpdate=new h.a,e._positionsRemoved=new h.a,e._displayMode=1,e._updatePositionPLHandler=e._updatePositionPL.bind(e),e}return Object(r.c)(e,t),e.prototype.destroy=function(){this.stopService()},e.prototype.positions=function(){return Array.from(this._positions.values())},e.prototype.find=function(t){return this._positions.get(t)||null},e.prototype.positionUpdate=function(){return this._positionUpdate},e.prototype.positionsRemoved=function(){return this._positionsRemoved},e.prototype.isDisplayModeTrades=function(){return 0===this._displayMode},e.prototype.stopService=function(){this._clearPositions();var t=Object(n.ensureNotNull)(this.activeBroker())
;this.isDisplayModeTrades()?t.tradeUpdate.unsubscribeAll(this):t.positionUpdate.unsubscribeAll(this)},e.prototype.startService=function(){this._clearPositions(),this._displayMode=function(t){if(null===t)return 1;var e=t.metainfo().configFlags;return e.supportTrades?e.supportPositionBrackets?1:e.supportCloseTrade?0:1:1}(this.activeBroker()),this._requestPositions()},e.prototype._clearPositions=function(){for(var t=Object(n.ensureNotNull)(this.activeBroker()),e=Array.from(this._positions.keys()),i=0,r=e;i<r.length;i++){var o=r[i];this.isDisplayModeTrades()?t.unsubscribeTradePL(o,this._updatePositionPLHandler):t.unsubscribePL(o,this._updatePositionPLHandler)}this._positions.clear(),this._positionsRemoved.fire(e)},e.prototype._requestPositions=function(){return Object(r.b)(this,void 0,void 0,(function(){var t,e,i,o,n,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(t=this.activeBroker())?[4,(e=this.isDisplayModeTrades())?t.trades():t.positions()]:[2];case 1:for(i=r.sent(),o=0,n=i;o<n.length;o++)s=n[o],this._addPosition(s);return e?t.tradeUpdate.subscribe(this,this._addPosition):t.positionUpdate.subscribe(this,this._addPosition),[2]}}))}))},e.prototype._addPosition=function(t){var e=t.id,i=this._positions.has(e),r=Object(n.ensureNotNull)(this.activeBroker());Et.logDebug("Update position. Symbol:"+t.symbol+" , qty:"+t.qty);var o=this.isDisplayModeTrades();if(t.qty){var s=this._getPositionData(t);this._positions.set(e,s),this._positionUpdate.fire(s),i||(o?r.subscribeTradePL(e,this._updatePositionPLHandler):r.subscribePL(e,this._updatePositionPLHandler))}else i&&(o?r.unsubscribeTradePL(e,this._updatePositionPLHandler):r.unsubscribePL(e,this._updatePositionPLHandler),this._positions.delete(e),this._positionsRemoved.fire([e]))},e.prototype._updatePositionPL=function(t,e){var i=Object(n.ensureDefined)(this._positions.get(t));i.pl=Object(jt.isNumber)(e)?e:null,i.profitState=Tt(e),this._positionUpdate.fire(i)},e.prototype._getPositionData=function(t){var e=Object(n.ensureNotNull)(this.activeBroker()).metainfo().configFlags,i=this._positions.get(t.id),o=this.isDisplayModeTrades(),s="neutral",a=t.pl||i&&i.pl||null;return null!==a&&(s=Tt(a)),Object(r.a)(Object(r.a)(Object(r.a)({},void 0!==i?i:{}),t),{pl:a,price:Math.abs(o?t.price:t.avgPrice),qtyBySide:Math.abs(t.qty)*(1===t.side?1:-1),profitState:s,supportClose:Boolean(o?e.supportCloseTrade&&t.canBeClosed:e.supportClosePosition),supportReverse:Boolean(!o&&e.supportReversePosition),supportBrackets:Boolean(o?e.supportTradeBrackets:e.supportPositionBrackets)})},e}(m.a),Nt=Object(p.getLogger)("Trading.OrderSource");var It=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._activeOrders=new Map,e._activeOrderUpdate=new h.a,e._activeOrdersRemoved=new h.a,e}return Object(r.c)(e,t),e.prototype.destroy=function(){this.stopService()},e.prototype.orders=function(){return Object(n.ensureNotNull)(this.activeBroker()).orders()},e.prototype.find=function(t){return this._activeOrders.get(t)||null},e.prototype.activeOrders=function(){
return Array.from(this._activeOrders.values())},e.prototype.activeOrdersUpdated=function(){return this._activeOrderUpdate},e.prototype.activeOrdersRemoved=function(){return this._activeOrdersRemoved},e.prototype.stopService=function(){this._clearOrders(),Object(n.ensureNotNull)(this.activeBroker()).orderUpdate.unsubscribeAll(this)},e.prototype.startService=function(){this._clearOrders(),this._requestOrders()},e.prototype._clearOrders=function(){var t=Array.from(this._activeOrders.keys());this._activeOrders.clear(),this._activeOrdersRemoved.fire(t)},e.prototype._requestOrders=function(){return Object(r.b)(this,void 0,void 0,(function(){var t,e,i,o,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(t=this.activeBroker())?[4,t.orders()]:[2];case 1:for(e=r.sent(),i=0,o=e;i<o.length;i++)n=o[i],this._addActiveOrder(n);return t.orderUpdate.unsubscribeAll(this),t.orderUpdate.subscribe(this,this._addActiveOrder),[2]}}))}))},e.prototype._addActiveOrder=function(t){if(2!==t.type){var e=t.id,i=this._activeOrders.has(e);if(6===t.status||3===t.status){var r=this._getOrderData(t);this._activeOrders.set(e,r),this._activeOrderUpdate.fire(r)}else i&&(this._activeOrders.delete(e),this._activeOrdersRemoved.fire([e]))}},e.prototype._getOrderData=function(t){var e=Object(n.ensureNotNull)(this.activeBroker()).metainfo().configFlags,i=this._activeOrders.get(t.id),o=function(t){return 1===t.type?Object(n.ensureDefined)(t.limitPrice):Object(n.ensureDefined)(t.stopPrice)}(t);return Object(jt.isNumber)(o)||Nt.logError("order price is not defined"),Object(r.a)(Object(r.a)(Object(r.a)({},void 0!==i?i:{}),t),{price:o,isActive:6===t.status,considerFilledQty:!0,supportModify:Boolean(e.supportModifyOrder&&(e.supportTrailingStop&&e.supportModifyTrailingStop||t.stopType!==L.a.TrailingStop))})},e}(m.a),At=i("QfUd"),Lt=i("kcTO"),Vt=window.t("A broker is not connected"),Mt=window.t("This symbol can't be traded through this broker"),Rt=window.t("No bids"),Ut=window.t("No asks"),qt=window.t("Buy Market"),Ft=window.t("Sell Market"),xt=window.t("Spread"),Wt=window.t("Amount"),Qt=window.t("Quantity"),Ht=A.enabled("broker_button"),zt=function(){function t(t,e,i,r){var o=this;this.ask=new C.a(null),this.askTooltip=new C.a(qt),this.bid=new C.a(null),this.bidTooltip=new C.a(Ft),this.spread=new C.a(null),this.spreadTooltip=new C.a(xt),this.qty=new C.a(null),this.qtyTooltip=new C.a(""),this.brokerIconUrl=new C.a(null),this.isQtyVisible=new C.a(!1),this.hasAskBidAdditionalPrecision=new C.a(!1),this.canTrade=new C.a(!0),this._globalVisibility=null,this._isSymbolTradableResult=new At.a(null),this._formatter=null,this._spreadFormatter=null,this._symbol=null,this._dataEvents=t,this._getSymbolName=e,this._realtimeProvider=i.realtimeProvider,this._suggestedQty=i.suggestedQty,this._onNeedSelectBroker=i.onNeedSelectBroker,this._toggleTradingWidget=i.toggleTradingWidget,this._brokerCommandsUI=i.brokerCommandsUI,this._updateRealtimeDataHandler=this._updateRealtimeData.bind(this),this._isBrokerConnected=Object(Bt.c)((function(){
return null!==o._realtimeProvider.activeBroker()}),this._realtimeProvider.onStatusChanged),this._isBrokerConnected.subscribe(this._updateIsSymbolTraded.bind(this)),this._isBrokerConnected.subscribe(this._updateQtyTooltip.bind(this),{callWithLast:!0}),this._isBrokerConnected.subscribe(this._updateBrokerIcon.bind(this)),this.visible=new C.a(!1),this.visible.subscribe(this._toggleState.bind(this),{callWithLast:!0}),this._showSellBuyButtons=r.showSellBuyButtons.spawn(),this._showSellBuyButtons.subscribe(this._updateVisibility.bind(this),{callWithLast:!0}),this._isInstantMode=r.noConfirmEnabled.spawn(),this._themeName=r.themeName.spawn(),this._themeName.subscribe(this._updateBrokerIcon.bind(this),{callWithLast:!0}),this._tradePossibilityComputedWV=Object(P.combine)((function(){return{}}),this._isBrokerConnected,this._isSymbolTradableResult,this.ask,this.bid),this._tradePossibilityComputedWV.subscribe(this._updateTradePossibilityAndTooltip.bind(this),{callWithLast:!0}),this._isQtyVisibleComputedWV=Object(P.combine)((function(){return{}}),this.canTrade,this._isInstantMode),this._isQtyVisibleComputedWV.subscribe(this._updateIsQtyVisible.bind(this),{callWithLast:!0})}return t.prototype.destroy=function(){var t;this._stop(),this._showSellBuyButtons.destroy(),null===(t=this._globalVisibility)||void 0===t||t.destroy(),this._isInstantMode.destroy(),this._tradePossibilityComputedWV.destroy(),this._isQtyVisibleComputedWV.destroy(),this._themeName.destroy()},t.prototype.setGlobalVisibility=function(t){Object(n.assert)(null===this._globalVisibility,"GlobalVisibility can be set only once"),this._globalVisibility=t.spawn(),this._globalVisibility.subscribe(this._updateVisibility.bind(this),{callWithLast:!0})},t.prototype.tryToPlaceSellOrder=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this._tryToPlaceOrder(parseFloat(Object(n.ensureNotNull)(this.bid.value())),-1)];case 1:return t.sent(),[2]}}))}))},t.prototype.tryToPlaceBuyOrder=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this._tryToPlaceOrder(parseFloat(Object(n.ensureNotNull)(this.ask.value())),1)];case 1:return t.sent(),[2]}}))}))},t.prototype.getQtyInfo=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return null!==this._symbol&&this.canTrade.value()?[4,this._realtimeProvider.symbolInfo(this._symbol)]:[2,null];case 1:return[2,t.sent().qty]}}))}))},t.prototype.setQty=function(t){this.qty.setValue(String(t))},t.prototype.applyQty=function(){if(null!==this._symbol&&this.canTrade.value()){var t=this.qty.value();null!==t&&this._suggestedQty.setValue(this._symbol,Number(t))}},t.prototype._updateVisibility=function(){var t=(null===this._globalVisibility||this._globalVisibility.value())&&this._showSellBuyButtons.value();this.visible.setValue(t)},t.prototype._tryToPlaceOrder=function(t,e){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s
;return Object(r.d)(this,(function(r){switch(r.label){case 0:return null!==this._realtimeProvider.activeBroker()?[3,2]:[4,this._toggleTradingWidget()];case 1:return r.sent(),this._onNeedSelectBroker.fire(),[2];case 2:return i=Number(this.qty.value())||1,o=this._isMarketOrderSupported()?2:1,s={symbol:Object(n.ensureNotNull)(this._symbol),qty:i,side:e,type:o,seenPrice:null},1===o&&(s.limitPrice=t),[4,Object(n.ensureNotNull)(this._brokerCommandsUI()).placeOrder(s,!0)];case 3:return r.sent(),[2]}}))}))},t.prototype._toggleState=function(t){t?this._start():this._stop()},t.prototype._start=function(){this._dataEvents.symbolResolved().subscribe(this,this._createTradedSymbol),this._dataEvents.symbolError().subscribe(this,this._createTradedSymbol),this._createTradedSymbol(),this._suggestedQty.changed.subscribe(this,this._updateQty)},t.prototype._stop=function(){this._clearTradedSymbol(),this._symbol=null,this._dataEvents.symbolResolved().unsubscribeAll(this),this._dataEvents.symbolError().unsubscribeAll(this),this._suggestedQty.changed.unsubscribeAll(this)},t.prototype._createTradedSymbol=function(){var t=this._getSymbolName();t!==this._symbol&&(this._clearTradedSymbol(),t.length>0&&this._initTradedSymbol(t))},t.prototype._initTradedSymbol=function(t){this._symbol=t,this._updateIsSymbolTraded(),this._realtimeProvider.subscribeRealtime(this._symbol,this._updateRealtimeDataHandler)},t.prototype._clearTradedSymbol=function(){this.ask.setValue(null),this.bid.setValue(null),this.spread.setValue(null),this.qty.setValue(null),null!==this._symbol&&(this._realtimeProvider.unsubscribeRealtime(this._symbol,this._updateRealtimeDataHandler),this._symbol=null,this._updateIsSymbolTraded())},t.prototype._isMarketOrderSupported=function(){var t=this._realtimeProvider.activeBroker();return null===t||Boolean(t.metainfo().configFlags.supportMarketOrders)},t.prototype._updateTradePossibilityAndTooltip=function(){this._updateCanTrade(),this._updateSellBuyTooltip()},t.prototype._updateCanTrade=function(){var t=!1,e=!1,i=this._isSymbolTradableResult.value();this._isBrokerConnected.value()&&null!==i&&i.tradable&&(e=!0,this.canTrade.value()||(t=!0)),this.canTrade.setValue(e),t&&null!==this._symbol&&this._updateQty(this._symbol)},t.prototype._updateSellBuyTooltip=function(){var t=this._isSymbolTradableResult.value(),e=null,i=null,r=null,o=null===this.ask.value(),n=null===this.bid.value();null===t||t.tradable?(o||n)&&(o&&(i=Ut),n&&(r=Rt)):e=t.shortReason?t.shortReason:this._isBrokerConnected.value()?Mt:Vt,this.askTooltip.setValue(i||e||qt),this.bidTooltip.setValue(r||e||Ft)},t.prototype._updateRealtimeData=function(t,e,i){this._formatter=i.formatter,this._spreadFormatter=i.spreadFormatter;var r=e.ask,o=e.bid,n=Object(s.isNumber)(r)?this._formatter.format(r):null,a=Object(s.isNumber)(o)?this._formatter.format(o):null;this.ask.setValue(n),this.bid.setValue(a);var c=e.spread||Object(s.isNumber)(r)&&Object(s.isNumber)(o)&&r-o||0,u=Object(s.isNumber)(e.spread)?this._spreadFormatter:this._formatter;this.spread.setValue(u.format(c));var l=!1
;Object(Lt.isFormatterHasForexAdditionalPrecision)(this._formatter)&&(l=this._formatter.hasForexAdditionalPrecision()),this.hasAskBidAdditionalPrecision.setValue(l)},t.prototype._updateIsSymbolTraded=function(){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(e){switch(e.label){case 0:return null===this._symbol?(this._isSymbolTradableResult.setValue(null),[2]):[4,this._realtimeProvider.isTradable(this._symbol)];case 1:return t=e.sent(),this._isSymbolTradableResult.setValue(Object(jt.clone)(t)),[2]}}))}))},t.prototype._updateQty=function(t){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(i){switch(i.label){case 0:return t===this._symbol&&this.canTrade.value()?[4,this._suggestedQty.value(t)]:[2];case 1:return e=i.sent(),(!isFinite(e)||e<=0)&&(e=1),this.qty.setValue(""+Object(s.fixComputationError)(e)),[2]}}))}))},t.prototype._updateIsQtyVisible=function(){var t=this._isInstantMode.value()&&this.canTrade.value();this.isQtyVisible.setValue(t)},t.prototype._updateQtyTooltip=function(){this.qtyTooltip.setValue(this._getQtyTooltip())},t.prototype._getQtyTooltip=function(){var t=this._realtimeProvider.activeBroker();return null!==t&&t.metainfo().configFlags.showQuantityInsteadOfAmount?Qt:Wt},t.prototype._updateBrokerIcon=function(){if(Ht){var t,e=this._realtimeProvider.activeBroker();if(null!==e){var i=e.metainfo();t="dark"===this._themeName.value()&&i.logoMiniBlackUrl?i.logoMiniBlackUrl:i.logoMiniUrl}this.brokerIconUrl.setValue(t||null)}},t}(),Gt=(i("LVLx"),i("bdgK")),Kt=i("EOiv"),Jt=i("AvGy"),Yt=i("qBrV"),Xt=i("PoSe"),Zt=i.n(Xt),$t=i("N8pX"),te=i("0jws"),ee=i("F+J5"),ie=i("OKVU"),re=parseInt(ee["css-value-padding"]);function oe(t,e,i,r){var o=t.querySelector("."+r);if(!i)return null!==o&&o.remove(),void Object(Yt.a)(t,e);null===o&&((o=document.createElement("span")).classList.add(r),t.appendChild(o)),Object(Yt.a)(Object(n.ensureNotNull)(o),e.slice(-1)),Object(Yt.a)(t,e.slice(0,-1))}var ne=function(){function t(t,e,i,r){var o=this;this.element=document.createElement("div"),this._sellButtonEl=document.createElement("div"),this._sellButtonTextEl=document.createElement("span"),this._buyButtonEl=document.createElement("div"),this._buyButtonTextEl=document.createElement("span"),this._spreadQtyWrapper=document.createElement("div"),this._spreadEl=document.createElement("div"),this._qtyEl=document.createElement("div"),this._qtyTextEl=document.createElement("span"),this._brokerButtonEl=document.createElement("div"),this._brokerIconWrapEl=document.createElement("div"),this._isCalcOpened=!1,this._calcContainer=document.createElement("div"),this._sellLoader=new Kt.a(this._sellButtonEl,{className:$t.loader}),this._buyLoader=new Kt.a(this._buyButtonEl,{className:$t.loader}),this._isHiddenByViewport=!1,this._mode=2,this._height=new C.a(0),this._windowResizeHandlerThrottle=Zt()(this._windowResizeHandler.bind(this),100),this._resizeObserver=null,this._cachedBreakPoints={},this._parentWidth=0,this._getCurrentQty=function(){var t=o._qty.value()
;return null!==t?Number(t):null},this._model=t,this._ask=this._model.ask.spawn(),this._ask.subscribe(this._updateBuyButton.bind(this)),this._bid=this._model.bid.spawn(),this._bid.subscribe(this._updateSellButton.bind(this)),this._spread=this._model.spread.spawn(),this._spread.subscribe(this._updateSpread.bind(this)),this._qty=this._model.qty.spawn(),this._qty.subscribe(this._updateQty.bind(this)),this._brokerIconUrl=this._model.brokerIconUrl.spawn(),this._brokerIconUrl.subscribe(this._updateBrokerIconImage.bind(this),{callWithLast:!0}),this._trackEvent=i,this._render(),this._askTooltip=this._model.askTooltip.spawn(),this._askTooltip.subscribe(this._updateButtonTooltip.bind(this,this._buyButtonEl),{callWithLast:!0}),this._bidTooltip=this._model.bidTooltip.spawn(),this._bidTooltip.subscribe(this._updateButtonTooltip.bind(this,this._sellButtonEl),{callWithLast:!0}),this._spreadTooltip=this._model.spreadTooltip.spawn(),this._spreadTooltip.subscribe(this._updateButtonTooltip.bind(this,this._spreadEl),{callWithLast:!0}),this._qtyTooltip=this._model.qtyTooltip.spawn(),this._qtyTooltip.subscribe(this._updateButtonTooltip.bind(this,this._qtyEl),{callWithLast:!0}),this._isVisible=this._model.visible.spawn(),this._isVisible.subscribe(this._updateVisibility.bind(this),{callWithLast:!0}),this._isQtyVisible=this._model.isQtyVisible.spawn(),this._isQtyVisible.subscribe(this._updateQtyVisibility.bind(this),{callWithLast:!0}),this._isLastDigitSup=this._model.hasAskBidAdditionalPrecision.spawn(),this._isLastDigitSup.subscribe(this._updateLastDigitSup.bind(this)),this._highButtonsMode=e.spawn(),this._highButtonsMode.subscribe(this._updateHighButtonsMode.bind(this),{callWithLast:!0}),this._withBgButtonsMode=this._model.canTrade.spawn(),this._withBgButtonsMode.subscribe(this._updateBgButtonsMode.bind(this),{callWithLast:!0}),this._sellButtonHandler=this._onSellButton.bind(this),this._buyButtonHandler=this._onBuyButton.bind(this),this._qtyHandler=this._toggleCalcVisibility.bind(this),this._sellButtonEl.addEventListener("click",this._sellButtonHandler),this._buyButtonEl.addEventListener("click",this._buyButtonHandler),this._qtyEl.addEventListener("click",this._qtyHandler),this._brokerButtonEl.addEventListener("click",r),window.addEventListener("resize",this._windowResizeHandlerThrottle),this._windowResizeHandler()}return t.prototype.destroy=function(){var t;this._ask.destroy(),this._askTooltip.destroy(),this._bid.destroy(),this._bidTooltip.destroy(),this._spread.destroy(),this._spreadTooltip.destroy(),this._qty.destroy(),this._qtyTooltip.destroy(),this._isVisible.destroy(),this._isQtyVisible.destroy(),this._isLastDigitSup.destroy(),this._highButtonsMode.destroy(),this._withBgButtonsMode.destroy(),this._brokerIconUrl.destroy(),this._sellButtonEl.removeEventListener("click",this._sellButtonHandler),this._buyButtonEl.removeEventListener("click",this._buyButtonHandler),this._qtyEl.removeEventListener("click",this._qtyHandler),null===(t=this._resizeObserver)||void 0===t||t.disconnect(),this._resizeObserver=null,this.element.remove(),
delete this.element,window.removeEventListener("resize",this._windowResizeHandlerThrottle)},t.prototype.updateModeByWidth=function(t){var e=this._cachedBreakPoints[0],i=this._cachedBreakPoints[1];this._mode=void 0!==e&&t<e?0:void 0!==i&&t<i?1:2,this._parentWidth=t,this.element.classList.toggle($t.column,1===this._mode),this._updateVisibility()},t.prototype.height=function(){return this._height},t.prototype.renderTo=function(t,e){void 0!==e?t.insertBefore(this.element,e):t.appendChild(this.element),null===this._resizeObserver&&(this._resizeObserver=new Gt.default(this._updateBreakPointsAndSize.bind(this))),this._resizeObserver.unobserve(this.element),this._resizeObserver.observe(this.element)},t.prototype.isHiddenByViewport=function(){return this._isHiddenByViewport},t.prototype._render=function(){var t=this._bid.value()||"...";this._sellButtonTextEl.appendChild(document.createTextNode(t)),this._sellButtonTextEl.classList.add($t.buttonText),this._sellButtonEl.append(this._sellButtonTextEl),this._sellButtonEl.classList.add("apply-common-tooltip",$t.button,$t.sellButton);var e=this._spread.value()||"";this._spreadEl.appendChild(document.createTextNode(String(e))),this._spreadEl.classList.add("apply-common-tooltip",$t.spread);var i=this._qty.value()||"";this._qtyTextEl.appendChild(document.createTextNode(i)),this._qtyEl.append(this._qtyTextEl),this._qtyEl.classList.add("apply-common-tooltip",$t.button,$t.qty),this._spreadQtyWrapper.classList.add($t.spreadQtyWrapper),this._spreadQtyWrapper.appendChild(this._spreadEl),this._spreadQtyWrapper.appendChild(this._qtyEl);var r=this._ask.value()||"...";this._buyButtonTextEl.appendChild(document.createTextNode(String(r))),this._buyButtonTextEl.classList.add($t.buttonText),this._buyButtonEl.append(this._buyButtonTextEl),this._buyButtonEl.classList.add("apply-common-tooltip",$t.button,$t.buyButton),this._brokerButtonEl.appendChild(this._brokerIconWrapEl),this._brokerIconWrapEl.classList.add($t.brokerButtonIconWrap),this._brokerButtonEl.classList.add($t.brokerButton),this.element.appendChild(this._sellButtonEl),this.element.appendChild(this._spreadQtyWrapper),this.element.appendChild(this._buyButtonEl),this.element.appendChild(this._brokerButtonEl),this.element.classList.add($t.wrapper),this.element.classList.toggle($t.touchMode,Jt.a)},t.prototype._updateBreakPointsAndSize=function(t){var e=t[0],i=2*re;2===this._mode&&(this._cachedBreakPoints[1]=Math.round(e.contentRect.width)+i),1===this._mode&&(this._cachedBreakPoints[0]=Math.round(e.contentRect.width)+i),this.updateModeByWidth(this._parentWidth);var r=e.contentRect.height>0?Math.round(e.contentRect.height)+i:0;this._height.setValue(r)},t.prototype._updateBrokerIconImage=function(){var t=this._brokerIconUrl.value(),e=null===t;this._brokerIconWrapEl.innerHTML=e?ie:'<image src="'+t+'" alt="Account Manager" />',this._brokerButtonEl.classList.toggle($t.brokerButtonDefault,e)},t.prototype._onSellButton=function(){return Object(r.b)(this,void 0,void 0,(function(){var t,e=this;return Object(r.d)(this,(function(i){switch(i.label){case 0:
return null===this._bid.value()?[2]:(t=this._highButtonsMode.value(),this._trackEvent("Sell/Buy Buttons","Sell",t?"Instant":"Not Instant"),t&&this._withBgButtonsMode.value()&&this._toggleLoaderVisibility(this._sellButtonEl,this._sellLoader,!0),[4,this._model.tryToPlaceSellOrder()]);case 1:return i.sent(),t&&this._withBgButtonsMode.value()&&setTimeout((function(){return e._toggleLoaderVisibility(e._sellButtonEl,e._sellLoader,!1)}),300),[2]}}))}))},t.prototype._onBuyButton=function(){return Object(r.b)(this,void 0,void 0,(function(){var t,e=this;return Object(r.d)(this,(function(i){switch(i.label){case 0:return null===this._ask.value()?[2]:(t=this._highButtonsMode.value(),this._trackEvent("Sell/Buy Buttons","Buy",t?"Instant":"Not Instant"),t&&this._withBgButtonsMode.value()&&this._toggleLoaderVisibility(this._buyButtonEl,this._buyLoader,!0),[4,this._model.tryToPlaceBuyOrder()]);case 1:return i.sent(),t&&this._withBgButtonsMode.value()&&setTimeout((function(){return e._toggleLoaderVisibility(e._buyButtonEl,e._buyLoader,!1)}),300),[2]}}))}))},t.prototype._toggleLoaderVisibility=function(t,e,i){t.classList.toggle($t.loading,i),e.toggleVisibility(i)},t.prototype._updateBuyButton=function(t){var e=null!==t&&this._isLastDigitSup.value();oe(this._buyButtonTextEl,""+(t||"..."),e,$t.lastCharSup)},t.prototype._updateSellButton=function(t){var e=null!==t&&this._isLastDigitSup.value();oe(this._sellButtonTextEl,""+(t||"..."),e,$t.lastCharSup)},t.prototype._updateSpread=function(t){var e=""+(t||"");Object(Yt.a)(this._spreadEl,e),this._updateVisibilityForSpreadQtyWrapper()},t.prototype._updateQty=function(t){var e=""+(t||"");!this._isCalcOpened&&e.length>0&&(e=Object(w.a)(Number(e))),Object(Yt.a)(this._qtyTextEl,e)},t.prototype._updateHighButtonsMode=function(t){this.element.classList.toggle($t.highButtons,t)},t.prototype._updateBgButtonsMode=function(t){this.element.classList.toggle($t.withoutBg,!t)},t.prototype._updateVisibilityForSpreadQtyWrapper=function(){var t=!this._isQtyVisible.value()&&null===this._spread.value();this._spreadQtyWrapper.classList.toggle(te.blockHidden,t)},t.prototype._updateQtyVisibility=function(t){this._qtyEl.classList.toggle(te.blockHidden,!t),this._spreadQtyWrapper.classList.toggle($t.withoutQty,!t),this._updateVisibilityForSpreadQtyWrapper()},t.prototype._updateVisibility=function(){var t=this._isVisible.value()&&0!==this._mode&&!this._isHiddenByViewport;this.element.classList.toggle(te.blockHidden,!t)},t.prototype._updateLastDigitSup=function(){this._updateBuyButton(this._ask.value()),this._updateSellButton(this._bid.value())},t.prototype._updateButtonTooltip=function(t,e){t.setAttribute("title",e)},t.prototype._toggleCalcVisibility=function(){this._isCalcOpened=!this._isCalcOpened,this._renderCalc()},t.prototype._closeCalc=function(){this._isCalcOpened=!1,this._updateQty(this._qty.value()),this._model.applyQty(),this._renderCalc()},t.prototype._renderCalc=function(){var t=this
;Promise.all([i.e("react"),i.e(3),i.e(19),i.e(22),i.e(90),i.e(103),i.e(2),i.e(18),i.e(21),i.e(73),i.e(78),i.e("trading-custom-widgets")]).then(i.bind(null,"Hmbi")).then((function(e){return Object(r.b)(t,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(i){switch(i.label){case 0:return[4,this._model.getQtyInfo()];case 1:return null===(t=i.sent())||e.render(this._isCalcOpened,this._calcContainer,Object(r.a)(Object(r.a)({},t),{withInput:!0,valueGetter:this._getCurrentQty,position:this._getCalcPosition(),targetEl:this._qtyEl,onClose:this._closeCalc.bind(this),onValueChange:this._model.setQty.bind(this._model),trackEventTarget:"Sell/Buy Buttons",trackEvent:this._trackEvent})),[2]}}))}))}))},t.prototype._getCalcPosition=function(){var t=this._qtyEl.getBoundingClientRect();return{x:t.left,y:t.bottom+2}},t.prototype._windowResizeHandler=function(){var t=window.innerWidth<600||window.innerHeight<440;this._isHiddenByViewport!==t&&(this._isHiddenByViewport=t,this._updateVisibility())},t}(),se=i("7KDR"),ae=window.t("Show Buy/Sell Buttons"),ce=function(){function t(t,e,i,r){this._showSellBuyButtons=r.showSellBuyButtons,this._trackEvent=i.trackEvent,this._model=new zt(t,e,i,r),this._renderer=new ne(this._model,r.noConfirmEnabled,i.trackEvent,i.onShowAccountManager)}return t.prototype.destroy=function(){this._model.destroy(),this._renderer.destroy()},t.prototype.renderTo=function(t,e){this._renderer.renderTo(t,e)},t.prototype.setGlobalVisibility=function(t){this._model.setGlobalVisibility(t)},t.prototype.visibility=function(){return this._model.visible},t.prototype.updateWidgetModeBySize=function(t){this._renderer.updateModeByWidth(t.w)},t.prototype.contextMenuActions=function(){var t=this;return this._renderer.isHiddenByViewport()?[]:[new se.Action({checkable:!0,checked:this._showSellBuyButtons.value(),label:ae,onExecute:function(){var e=!t._showSellBuyButtons.value();t._showSellBuyButtons.setValue(e),t._trackEvent("SellBuyButtonsWidget context menu","Show Sell/Buy Button",e?"Check":"Uncheck")}})]},t.prototype.height=function(){return this._renderer.height()},t}();var ue,le=i("NQw4"),de=i("MXV9");i.d(e,"showSellBuyButtonsDefault",(function(){return ve})),i.d(e,"Trading",(function(){return me}));var he,pe=Object(p.getLogger)("Trading.Core"),be=((ue={})[1]="Connected",ue[2]="Connecting",ue[3]="Disconnected",ue[4]="Error",ue);!function(t){t[t.Paper=43000516466]="Paper",t[t.CQG=43000516372]="CQG",t[t.OANDA=43000516375]="OANDA",t[t.FOREXCOM=43000516374]="FOREXCOM"}(he||(he={}));var _e={enabled:new C.a(!1),name:"alert/alarm_clock"};var fe=A.enabled("buy_sell_buttons"),ye=o.t("Show Buy/Sell Buttons"),ve=!0,me=function(){function t(t){var e=this;this.accountType=new C.a,this.onBrokerChange=new h.a,this.onBrokerLoading=new h.a,this.onConnectionStatusChange=new h.a,this.onNewNotification=new h.a,this.onNeedSelectBroker=new h.a,this.onNotificationsChanged=new h.a,this.showSellBuyButtons=new C.a,this.noConfirmEnabled=new C.a,this.showOnlyRejectionNotifications=new C.a,this.showPricesWithZeroVolume=new C.a,
this.showSpread=new C.a,this.orderExecutedSoundParams=_e,this._activeBroker=null,this._orderViewController=null,this._orderControllerPromise=null,this._brokerCommandsUI=null,this._showPricesWithZeroVolume=new C.a,this._showSpread=new C.a,this._offlineListener=this._offlineHandler.bind(this),this._onlineListener=this._onlineHandler.bind(this),this._notifications=[],this._account=null,this._domPanelVisibility=new C.a(!1),this._orderPanelVisibility=new C.a(!1),this._switchingBroker=!1,this._accountVerificationPromise=null,this._chartWidgetCollection=null,this._updateAccountId=function(){e._account=Object(n.ensureNotNull)(e._activeBroker).currentAccount(),e.onNotificationsChanged.fire(e.getNotifications())},this._resizerBridge=t,this._realtimeProvider=new v((function(){return e.activeBroker()}),this.onBrokerChange,this.onConnectionStatusChange,this.suggestedQty()),this._positionService=new Dt(this),this._ordersService=new It(this),this._tradingStat=new g(this),this.tradingPanel=new rt(t);var r=new Y(t,(function(){return e.tradingPanel.close()}));this.tradingPanel.addPage(Z.d.DomPanel,r);var o=new X;this.tradingPanel.addPage(Z.d.OrderPanel,o);var s=k.getValue(u.a.TRADING_PANEL_ACTIVE_PAGE),a=k.getBool(u.a.TRADING_PANEL_OPENED,A.enabled("show_order_panel_on_start"));this._applyCQGTerminalRedirectPatches(),s&&this.tradingPanel.activePage.setValue(s),a&&this.tradingPanel.open(),this.tradingPanel.isPageOpened(Z.d.OrderPanel)&&this.tradingPanel.isAvailable.value()&&this.setOrderPanelVisibility(!0),Object(P.combine)((function(){return{}}),this.tradingPanel.activePage,this.tradingPanel.isOpened).subscribe((function(){e._domPanelVisibility.setValue(e.tradingPanel.isPageOpened(Z.d.DomPanel)),e._orderPanelVisibility.setValue(e.tradingPanel.isPageOpened(Z.d.OrderPanel))})),this._loginDialogRenderer=Promise.all([i.e("react"),i.e(4),i.e(9),i.e(11),i.e(13),i.e(14),i.e(17),i.e(31),i.e(67),i.e(138),i.e(0),i.e(10),i.e("login-dialog")]).then(i.bind(null,"hdTl")).then((function(t){return new t.LoginDialogRenderer((function(){return e.selectBroker(null)}),e.trackEvent.bind(e),e._checkCQGCredentials.bind(e))}))}return t.prototype.setChartWidgetCollection=function(t){var e=this;Object(n.assert)(null===this._chartWidgetCollection,"ChartWidgetCollection can be set only once"),this._chartWidgetCollection=t,this._guiAccessor=new N(t),new gt(this),this._loadState(),k.onSync.subscribe(this,this._loadState);var i=function(){e._save()};this.showSellBuyButtons.subscribe(i),this.noConfirmEnabled.subscribe(i),this.showOnlyRejectionNotifications.subscribe(i),this._showPricesWithZeroVolume.subscribe(i),this._showSpread.subscribe(i),this.orderExecutedSoundParams.enabled.subscribe(i),window.addEventListener("offline",this._offlineListener),window.addEventListener("online",this._onlineListener),this.bindShortcuts(),this._registerCustomSources(t),this._registerCustomWidgets(t)},t.prototype.showPricesWith=function(){return{zeroVolume:this._showPricesWithZeroVolume,spread:this._showSpread}},t.prototype.domPanelVisibility=function(){
return this._domPanelVisibility},t.prototype.orderPanelVisibility=function(){return this._orderPanelVisibility},t.prototype.realtimeProvider=function(){return this._realtimeProvider},t.prototype.toggleTradingWidget=function(){return window.TradingView.bottomWidgetBar?window.TradingView.bottomWidgetBar.activateTradingTab():Promise.resolve()},t.prototype.tradingWizard=function(){return this._tradingWizard},t.prototype.showTradingProperties=function(){this._gui()&&this._gui().showTradingProperties()},t.prototype.brokersList=function(){return a.brokersList()},t.prototype.brokersPlans=function(){return this._getBrokerPlans()},t.prototype.activeBroker=function(){return this._activeBroker},t.prototype.brokerCommandsUI=function(){return this._brokerCommandsUI},t.prototype.trackEvent=function(t,e,i){var r=t?"["+t+"] "+e:e;if(this._gui()){var o=this._activeBroker?this._activeBroker.metainfo().id+" Trading":"Trading No Broker",n=this._activeBroker?this._activeBroker.currentAccountType():void 0;this._gui().trackEvent(o,r,i||n)}},t.prototype.selectBroker=function(t,e){void 0===e&&(e=!1),this._selectBrokerInternal(t,!0,e)},t.prototype.pickDefaultBroker=function(){if(!this._activeBroker){var t=null,e=this.brokersList().filter((function(t){return!t.configFlags.isSuspended}));if(1===e.length)t=e[0].id;else{var i=k.getValue(u.a.ACTIVE_BROKER);i&&e.some((function(t){return t.id===i}))&&(t=i)}t&&this.selectBroker(t)}},t.prototype.defaultContextMenuActions=function(t,e){var i=void 0===e?{}:e,n=i.onlyMainActions,s=void 0!==n&&n,a=i.gaOrigin,c=void 0===a?"Chart Context Menu":a;return Object(r.b)(this,void 0,void 0,(function(){var e,i,n,a,u,l,d,h,p,b,_=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this.suggestedQty().value(t.symbol)];case 1:return e=r.sent(),i=t.value||void 0,[4,this.realtimeProvider().quotesSnapshot(t.symbol)];case 2:return n=r.sent(),a=n.bid,u=n.ask,l=[],null!==t.value&&void 0!==u&&void 0!==a&&(t.value>=u||t.value<=a)?(d=(a+u)/2,p=(h=l.push).apply,b=[l],[4,this._makeSubActions(t,e,d,c)]):[3,4];case 3:p.apply(h,b.concat([r.sent()])),r.label=4;case 4:return l.push({name:"trade-new-order",action:function(){_.trackEvent(c,"New Order"),_._checkAndOpenOrderDialog({limitPrice:i,qty:e,stopPrice:i,symbol:t.symbol})},text:Object(I.appendEllipsis)(o.t("Create New Order")),statName:"NewOrder"}),!s&&A.enabled("property_pages")&&(l.push({separator:!0}),l.push({name:"trade-properties",action:function(){_.trackEvent(c,"Trading Properties"),_.showTradingProperties()},text:Object(I.appendEllipsis)(o.t("Trading Settings")),icon:de,statName:"Properties"})),[2,l]}}))}))},t.prototype.defaultDropdownMenuActions=function(t){var e=this,i="Bottom Panel Dropdown",r=[],n=this.activeBroker(),s=t||{showSellBuyButtons:fe,showOrderPanel:A.enabled("order_panel"),showDOM:A.enabled("dome_widget")&&n&&n.metainfo().configFlags.supportDOM,tradingProperties:!0,showHowToUse:n&&n.metainfo().configFlags.supportHowToUse};A.enabled("property_pages")||(s.tradingProperties=!1);var a,c={separator:!0};return s.showSellBuyButtons&&r.push({
action:function(){var t=!e.showSellBuyButtons.value();e.trackEvent(i,"Show Sell/Buy Buttons",t?"Check":"Uncheck"),e.showSellBuyButtons.setValue(t)},checkable:!0,checked:this.showSellBuyButtons.value(),checkedStateSource:function(){return e.showSellBuyButtons.value()},text:ye}),s.showOrderPanel&&A.enabled("order_panel")&&r.push({action:function(){var t=e.tradingPanel.isPageOpened(Z.d.OrderPanel);e.trackEvent(i,"Show Order Panel",t?"Uncheck":"Check"),e.setOrderPanelVisibility(!t)},checkable:!0,checked:this.tradingPanel.isPageOpened(Z.d.OrderPanel),checkedStateSource:function(){return e.tradingPanel.isPageOpened(Z.d.OrderPanel)},text:$.t("Show Order Panel")}),s.showDOM&&A.enabled("dome_widget")&&r.push({action:function(){var t=e.tradingPanel.isPageOpened(Z.d.DomPanel);e.trackEvent(i,"Show DOM",t?"Uncheck":"Check"),e.setDomPanelVisibility(!t)},checkable:!0,checked:this.tradingPanel.isPageOpened(Z.d.DomPanel),checkedStateSource:function(){return e.tradingPanel.isPageOpened(Z.d.DomPanel)},text:o.t("Show DOM")}),s.tradingProperties&&((a=r).length&&a.push(c),r.push({action:function(){e.showTradingProperties(),e.trackEvent(i,"Trading Properties")},text:Object(I.appendEllipsis)(o.t("Trading Settings")),icon:de})),r},t.prototype.chartContextMenuActions=function(t,e){return(this._activeBroker&&1===this._activeBroker.connectionStatus()?this._activeBroker.chartContextMenuActions(t,e):this.defaultContextMenuActions(t,e)).then((function(t){return Object(O.e)(t)}))},t.prototype.connectStatus=function(){return this._activeBroker?this._activeBroker.connectionStatus():3},t.prototype.bindShortcuts=function(){var t=this;if(!this._hotkeys){this._hotkeys=ot.createGroup({desc:"Trading"});var e=function(e){var i=t._gui().proSymbol();t.suggestedQty().value(i).then((function(r){t.realtimeProvider().quotesSnapshot(i).then((function(o){var n=o.bid,s=o.ask,a={price:void 0!==n&&void 0!==s?(n+s)/2:NaN,qty:r,side:e,symbol:i,type:2,seenPrice:null};t.trackEvent("Shortcut",-1===e?"Sell":"Buy"),t._checkAndPlaceOrder(a)}))}))};this._hotkeys.add({desc:"Buy",hotkey:ot.Modifiers.Shift+66,handler:function(){return e(1)}}),this._hotkeys.add({desc:"Sell",hotkey:ot.Modifiers.Shift+83,handler:function(){return e(-1)}})}},t.prototype.suggestedQty=function(){var t=this;if(!this._suggestedQty){var e=new h.a;this._suggestedQty={changed:e,setValue:function(i,r){t._setSymbolQty(i,r),e.fire(i)},value:function(e){return t.realtimeProvider().symbolInfo(e).then((function(i){var r=t._getSymbolQty(e)||t._getOldSymbolQty(e),o=void 0!==i.qty.default?i.qty.default:i.qty.min;return r?Object(s.alignTo)(Math.max(Math.min(i.qty.max,+r),i.qty.min),i.qty.step):o}))}}}return this._suggestedQty},t.prototype.formatter=function(t){return this.realtimeProvider().formatter(t)},t.prototype.showSuccessNotification=function(t,e,i){void 0===i&&(i=1e4),this.showOnlyRejectionNotifications.value()||this._showNotification(t,e,"success",i),A.enabled("show_trading_notifications_history")&&this._addNotificationRow(t,e,"success",i),this._log(t,e)},t.prototype.showErrorNotification=function(t,e,i){
void 0===i&&(i=25e3),this._showNotification(t,e,"danger",i),A.enabled("show_trading_notifications_history")&&this._addNotificationRow(t,e,"danger",i),this._log(t,e)},t.prototype.getNotifications=function(){var t=this;return this._notifications.filter((function(e){return e.account===t._account&&e.broker===(t._activeBroker?t._activeBroker.metainfo().id:null)}))},t.prototype.setDomPanelVisibility=function(t){t?this.tradingPanel.openPage(Z.d.DomPanel):this.tradingPanel.close()},t.prototype.setOrderPanelVisibility=function(t){this._getOrderViewController().then((function(e){t?e.openPanel():e.closePanel()}))},t.prototype.orderViewController=function(){return Object(n.ensureNotNull)(this._orderViewController)},t.prototype.tradingStat=function(){return this._tradingStat},t.prototype.verifyBrokerLiveAccount=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){return this._verifyLiveAccount(),[2,null!==this._accountVerificationPromise?this._accountVerificationPromise:Promise.reject("Account verification is not needed")]}))}))},t.prototype._getOrderViewController=function(){var t=this;return null===this._orderViewController?this._createOrderController().then((function(){return t._getOrderViewController()})):Promise.resolve(this._orderViewController)},t.prototype._getSymbolQty=function(t){var e=this._getBrokerSymbolsQty();if(e)return e[t]},t.prototype._getOldSymbolQty=function(t){var e=k.getFloat(u.a.QTY+t);return void 0!==e&&(this._setSymbolQty(t,e),k.remove(u.a.QTY+t)),e},t.prototype._getBrokerSymbolsQty=function(){if(this._activeBroker){var t=this._activeBroker.metainfo().id;return k.getJSON(u.a.BROKERS_QTY,{})[t]}},t.prototype._setSymbolQty=function(t,e){if(this._activeBroker){var i=this._activeBroker.metainfo().id,r=k.getJSON(u.a.BROKERS_QTY,{});r[i]||(r[i]={}),r[i][t]=e,k.setJSON(u.a.BROKERS_QTY,r)}},t.prototype._selectBrokerInternal=function(t,e,i,n){return void 0===i&&(i=!1),Object(r.b)(this,void 0,void 0,(function(){var s,l,d,h,p,b,_,f=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return!0===this._switchingBroker?(pe.logWarn("Broker is already selected, but a new broker id: "+t+" was received."),[2]):(s=this._activeBroker?this._activeBroker.metainfo().id:null,t===s?[2]:(this._activeBroker&&(l=this._activeBroker&&this._activeBroker.disconnectWarningMessage(),d=function(){return f._showReviewDialogIfNeeded(3,{disconnectType:c.DisconnectType.LogOut})},null===l?(d(),this._logOut(e,i,n)):Object(kt.showConfirm)({title:o.t("Log Out Confirmation"),text:l,mainButtonText:o.t("Log Out"),mainButtonIntent:"danger",cancelButtonText:o.t("Cancel"),onConfirm:function(t){var r=t.dialogClose;d(),f._logOut(e,i,n),r()},onCancel:function(t){var e=t.dialogClose;d(),e()}})),null==t?[3,3]:(this._switchingBroker=!0,h=void 0,p=function(t){f._activeBroker&&(pe.logWarn("Another one connecting broker detected. Disconnect it."),f._activeBroker.disconnect(i),f._activeBroker.destroy()),f._switchingBroker=!1,f._activeBroker=t,t.connectionStatusUpdate.subscribe(f,f._connectionListener),
f._brokerCommandsUI=new K(f._activeBroker,f._guiAccessor,f.noConfirmEnabled,f._getOrderViewController.bind(f),f.showErrorNotification.bind(f),f.trackEvent.bind(f)),t.tryRestoreSession(),k.setValue(u.a.ACTIVE_BROKER,t.metainfo().id),f.onBrokerChange.fire(f._activeBroker),f._getOrderViewController(),f._updateConnectionStatus(f.connectStatus())},[3,2])));case 1:b=r.sent(),h=b.filter((function(e){return e.slug_name===t}))[0],window.user.active_broker=h,r.label=2;case 2:return(_=a.createBrokerConnection(this,t,h)).then(p),_.catch((function(t){return pe.logError(t)})),[3,4];case 3:e&&setTimeout((function(){k.remove(u.a.ACTIVE_BROKER)})),this.onBrokerChange.fire(null),this._brokerCommandsUI=null,this._accountVerificationPromise=null,r.label=4;case 4:return[2]}}))}))},t.prototype._gui=function(){return this._guiAccessor},t.prototype._addNotificationRow=function(t,e,i,r){var o={id:this._notifications.length,account:this._account,broker:this._activeBroker?this._activeBroker.metainfo().id:null,time:new Date,title:t,text:e,type:i};this._notifications.push(o),this.onNewNotification.fire(o)},t.prototype._offlineHandler=function(){this._selectBrokerInternal(null,!1,!1,{disconnectType:c.DisconnectType.Offline}),pe.logNormal("The connection to the Internet was interrupted")},t.prototype._onlineHandler=function(){var t=k.getValue(u.a.ACTIVE_BROKER);t&&(this._selectBrokerInternal(t,!1),pe.logNormal("The connection to the Internet was restored"))},t.prototype._showNotification=function(t,e,i,r){this._gui()&&this._gui().showNotification(t,e,i,r)},t.prototype._showReviewDialogIfNeeded=function(t,e){if(null!==this._activeBroker)this._activeBroker},t.prototype._connectionListener=function(t,e){var i=this.connectStatus();this._showReviewDialogIfNeeded(t,e),3===t&&e&&e.disconnectType===c.DisconnectType.LogOut&&this._selectBrokerInternal(null,!1,!1,e),this._updateConnectionStatus(i,!0,e)},t.prototype._updateOrderPanelSpinnerState=function(){var t=this._orderViewController,e=2===this.connectStatus(),i=null!==t&&t.stateChanging.value();this.tradingPanel.isLoading.setValue(e||i)},t.prototype._updateConnectionStatus=function(t,e,i){var r=this;void 0===e&&(e=!0),this._updateOrderPanelSpinnerState(),this.onConnectionStatusChange.fire(t,i),this._log("Connection status",be[t]);var o=this._activeBroker;if(e){var n=this._activeBroker?this._activeBroker.metainfo().id:void 0;k.setValue(u.a.ACTIVE_BROKER,n,{forceFlush:!0})}this._activeBroker?1===t?(this._account=this._activeBroker.currentAccount(),this._guiAccessor.setBroker(this._activeBroker)):(this._accountVerificationPromise=null,null!==this._account&&this._activeBroker.currentAccountUpdate.unsubscribe(this,this._updateAccountId)):this._guiAccessor.setBroker(null),this._loginDialogRenderer.then((function(e){o===r._activeBroker&&e.updateStatus(o,t,i)}))},t.prototype._verifyLiveAccount=function(){if(null===this._accountVerificationPromise){var t=Object(n.ensureNotNull)(this._activeBroker);t.metainfo().configFlags.supportVerifyLiveAccount&&(t.currentAccountType(),c.AccountType.Live)}},
t.prototype._save=function(){k.setJSON(u.a.PROPERTIES,{showSellBuyButtons:+!!this.showSellBuyButtons.value(),noConfirmEnabled:+!!this.noConfirmEnabled.value(),qweqrq:+!!this.showOnlyRejectionNotifications.value(),showPricesWithZeroVolume:+!!this._showPricesWithZeroVolume.value(),showSpread:+!!this._showSpread.value(),orderExecutedSoundParams:JSON.stringify({enabled:+!!this.orderExecutedSoundParams.enabled.value(),name:this.orderExecutedSoundParams.name})})},t.prototype._loadState=function(){var t=k.getJSON(u.a.PROPERTIES,{});if(this.showSellBuyButtons.setValue(void 0!==t.showSellBuyButtons?!!t.showSellBuyButtons:ve),this.noConfirmEnabled.setValue(!!t.noConfirmEnabled),this.showOnlyRejectionNotifications.setValue(!!t.qweqrq),this._showPricesWithZeroVolume.setValue(!t.hasOwnProperty("showPricesWithZeroVolume")||t.showPricesWithZeroVolume),this._showSpread.setValue(!t.hasOwnProperty("showSpread")||t.showSpread),t.hasOwnProperty("orderExecutedSoundParams")){var e=JSON.parse(t.orderExecutedSoundParams);this.orderExecutedSoundParams.enabled.setValue(!!e.enabled),this.orderExecutedSoundParams.name=e.name}},t.prototype._log=function(t,e){pe.logNormal((this._activeBroker?this._activeBroker.metainfo().id+" Trading: ":"")+t+" - "+e)},t.prototype._makeSureCanTrade=function(){var t,e=this,i=this.activeBroker(),r=this.brokerCommandsUI(),o=Boolean(null===(t=window.TradingView.bottomWidgetBar)||void 0===t?void 0:t.isVisible().value());return i&&r?1===i.connectionStatus()||(o?this.toggleTradingWidget():Object(le.a)(),!1):(o?this.toggleTradingWidget().then((function(){return e.onNeedSelectBroker.fire()})):Object(le.a)(),!1)},t.prototype._checkAndPlaceOrder=function(t,e){void 0===e&&(e=!0),this._makeSureCanTrade()&&Object(n.ensureNotNull)(this.brokerCommandsUI()).placeOrder(t,e)},t.prototype._checkAndOpenOrderDialog=function(t){this._makeSureCanTrade()&&Object(n.ensureNotNull)(this.brokerCommandsUI()).placeOrder(t)},t.prototype._makeSubAction=function(t,e,i,r,n,s,a){var c=this,u=1===e?"Buy":"Sell",l=1===i?"Limit":"Stop",d=u+l,h={BuyLimit:o.t("Buy {symbol} Limit {qty} @ {value}").format({symbol:t.displaySymbol,qty:Object(w.a)(s),value:n}),SellStop:o.t("Sell {symbol} Stop {qty} @ {value}").format({symbol:t.displaySymbol,qty:Object(w.a)(s),value:n}),SellLimit:o.t("Sell {symbol} Limit {qty} @ {value}").format({symbol:t.displaySymbol,qty:Object(w.a)(s),value:n}),BuyStop:o.t("Buy {symbol} Stop {qty} @ {value}").format({symbol:t.displaySymbol,qty:Object(w.a)(s),value:n})};return{name:("trade-"+u+"-"+l).toLowerCase(),action:function(){c.trackEvent(a,u+" "+l);var o=1===i?"limitPrice":"stopPrice",n={qty:s,side:e,symbol:t.symbol,type:i,seenPrice:null};null!==r&&(n[o]=r),c._checkAndPlaceOrder(n)},text:h[d],statName:d}},t.prototype._createOrderController=function(){var t=this;return null===this._orderControllerPromise&&(this._orderControllerPromise=new Promise((function(e){Promise.all([i.e(103),i.e(73),i.e("order-view-controller")]).then(function(r){var o=i("3bpA").OrderViewController;e(new o({resizerBridge:t._resizerBridge,
onNeedSelectBroker:t.onNeedSelectBroker,realtimeProvider:t.realtimeProvider(),suggestedQty:t.suggestedQty(),trackEvent:t.trackEvent.bind(t),toggleTradingWidget:t.toggleTradingWidget.bind(t),showErrorNotification:t.showErrorNotification.bind(t)},{container:t.tradingPanel.container,isAvailable:t.tradingPanel.isAvailable,isOpened:t.tradingPanel.isOpened,activePage:t.tradingPanel.activePage,close:t.tradingPanel.close.bind(t.tradingPanel),openPage:t.tradingPanel.openPage.bind(t.tradingPanel)}))}.bind(null,i)).catch(void 0)})).then((function(e){t._orderControllerPromise=null,t._orderViewController=e,t._orderViewController.stateChanging.subscribe((function(){return t._updateOrderPanelSpinnerState()}))}))),this._orderControllerPromise},t.prototype._registerCustomSources=function(t){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(o){switch(o.label){case 0:return function(t,e){Object(r.b)(this,void 0,void 0,(function(){var o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,i.e("trading-custom-sources").then(i.bind(null,"bydf"))];case 1:return o=r.sent(),t.addCustomSource("bidask",(function(i,r){return new o.BidAsk(i,r,e.realtimeProvider(),(function(){t.activeChartWidget.value().showGeneralChartProperties(T.TabNames.symbol)}))})),[2]}}))}))}(t,this),St(t,this),[4,Promise.all([i.e("trading-custom-sources").then(i.bind(null,"J1Ip")),i.e("trading-custom-sources").then(i.bind(null,"QOhU"))])];case 1:return new((e=o.sent())[0].PositionsManager)(this._positionService,t,{brokerCommandsUI:this.brokerCommandsUI.bind(this),trackEvent:this.trackEvent.bind(this)}),new e[1].OrdersManager(this._ordersService,this._positionService,t,{activeBroker:this.activeBroker.bind(this),onConnectionStatusChange:this.onConnectionStatusChange,brokerCommandsUI:this.brokerCommandsUI.bind(this),trackEvent:this.trackEvent.bind(this)}),[2]}}))}))},t.prototype._registerCustomWidgets=function(t){fe&&function(t,e){t.addCustomWidgetToLegend((function(t,i){var r=t.mainSeries();return new ce(r.dataEvents(),function(t){return function(){var e=t.symbolInfo();return null!==e?e.pro_name||e.full_name||e.name||"":t.proSymbol()}}(r),{onNeedSelectBroker:e.onNeedSelectBroker,realtimeProvider:e.realtimeProvider(),suggestedQty:e.suggestedQty(),trackEvent:e.trackEvent.bind(e),toggleTradingWidget:e.toggleTradingWidget.bind(e),brokerCommandsUI:e.brokerCommandsUI.bind(e),onShowAccountManager:function(){}},{showSellBuyButtons:e.showSellBuyButtons,noConfirmEnabled:e.noConfirmEnabled,themeName:i})}),{block:0,position:0})}(t,this)},t.prototype._makeSubActions=function(t,e,i,o){return Object(r.b)(this,void 0,void 0,(function(){var n,a,c,u,l,d,h,p,b,_,f,y,v,m,g,k,w,P;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=[],a=this.activeBroker(),c=null===a,u=null===a,null===a||1!==a.connectionStatus()?[3,2]:[4,a.isTradable(t.symbol)];case 1:v=r.sent(),r.label=2;case 2:return null!==a&&v&&v.tradable&&null!==t.value?(m=a.metainfo().configFlags,[4,a.symbolInfo(t.symbol)]):[3,5];case 3:return g=r.sent(),B=t.value,
C=g.minTick,k=Object(s.fixComputationError)(Math.round(B/C)*C),l=k,h=k,p=k,d=k,c=Boolean(m.supportLimitOrders),u=Boolean(m.supportStopOrders),void 0!==g.limitPriceStep&&(w=Object(O.x)(t.value,g.limitPriceStep,1,1),l=w,h=Object(O.x)(t.value,g.limitPriceStep,1,-1)),void 0!==g.stopPriceStep&&(w=Object(O.x)(t.value,g.stopPriceStep,2,1),p=w,d=Object(O.x)(t.value,g.stopPriceStep,2,-1)),[4,a.formatter(t.symbol,!1)];case 4:return P=r.sent(),b=P.format(l),_=P.format(d),f=P.format(h),y=P.format(p),[3,6];case 5:l=h=p=d=t.value,b=_=f=y=t.formattedValue,r.label=6;case 6:return null!==t.value&&t.value<=i?(c&&n.push(this._makeSubAction(t,1,1,l,b,e,o)),u&&n.push(this._makeSubAction(t,-1,3,d,_,e,o))):null!==t.value&&t.value>=i&&(c&&n.push(this._makeSubAction(t,-1,1,h,f,e,o)),u&&n.push(this._makeSubAction(t,1,3,p,y,e,o))),[2,n]}var B,C}))}))},t.prototype._initPaidBrokersByUserRegion=function(){this._brokersListPromise=fetch("/api/v1/brokers/trading_panel",{method:"GET"}).then((function(t){return t.json()})).catch((function(t){pe.logWarn("Failed to fetch brokers info: "+t)}))},t.prototype._getBrokerPlans=function(){return Object(r.b)(this,void 0,void 0,(function(){var t,e;return Object(r.d)(this,(function(i){switch(i.label){case 0:t=[],i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._brokersListPromise];case 2:if(t=i.sent(),!Array.isArray(t))throw new Error("Request result is not valid");return[3,4];case 3:return e=i.sent(),pe.logError("Failed to fetch broker list by user region: "+e.message),[3,4];case 4:return[2,t]}}))}))},t.prototype._checkCQGCredentials=function(t){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(i){switch(i.label){case 0:return[2];case 1:return i.trys.push([1,4,,5]),this._activeBroker?[4,checkRealtimeDataSubscription(this._activeBroker.metainfo().id,t)]:[3,3];case 2:i.sent()&&this._guiAccessor.reconnectChartApi(!0),i.label=3;case 3:return[3,5];case 4:return e=i.sent(),pe.logError("Failed to fetch credentials verifier: "+e.message),[3,5];case 5:return[2]}}))}))},t.prototype._applyCQGTerminalRedirectPatches=function(){for(var t=k.getJSON(u.a.FAVORITE_BROKERS,[]),e=function(e){if(document.referrer.includes(e.toLowerCase()+".tradingview.com")&&!t.some((function(t){return t===e})))return t.push(e),k.setJSON(u.a.FAVORITE_BROKERS,t),"break"},i=0,r=["CQG","AMP"];i<r.length;i++){if("break"===e(r[i]))break}},t.prototype._showSupportDialog=function(t){t in he?showSupportDialog({initialState:SolutionCategoryName.Trading,solutionId:he[t]}):showSupportDialog({initialState:SolutionCategoryName.Trading})},t.prototype._logOut=function(t,e,i){var r=Object(n.ensureNotNull)(this._activeBroker);r.connectionStatusUpdate.unsubscribe(this,this._connectionListener),r.disconnect(e||!t),r.destroy(),this._activeBroker=null,this._updateConnectionStatus(3,t,i)},t}()},"F+J5":function(t,e,i){t.exports={"css-value-padding":"4px"}},GOhO:function(t,e,i){"use strict";var r=i("+DwS"),o=i("tc+8"),n=i.n(o);function s(t,e){var i=new n.a(t()),r={};return i.destroy=function(){e.unsubscribeAll(r)},
e.subscribe(r,(function(){i.setValue(t())})),i}var a=i("m/cY");function c(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var r=function(){return t.apply(void 0,e.map((function(t){return t.value()})))},o=Object(a.a)(r()),n=function(){return o.setValue(r())},s={},c=0,u=e;c<u.length;c++){var l=u[c];l.subscribe(s,n)}return o.destroy=function(){e.forEach((function(t){return t.unsubscribeAll(s)}))},o}i.d(e,"c",(function(){return r.a})),i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return c}))},Hgre:function(t,e,i){"use strict";i.r(e);var r=i("mrSG"),o=(i("P5fv"),i("YFKU")),n=i("Kxc7"),s=i("Eyy1"),a=function(){function t(t,e,i){var r=this;this._symbol=null,this._side=null,this._realtimeData=null,this._avgPrice=null,this._positionId=t,this._adapter=e,this._host=i,this._adapter.positionById(t).then((function(t){var e=Object(s.ensureDefined)(t);r._symbol=e.symbol,r._side=e.side,r._onPositionChanged(e),r._onRealtimeBinded=r._onRealtime.bind(r),r._adapter.subscribeRealtime(r._symbol,r._onRealtimeBinded),r._adapter.positionUpdate.subscribe(r,r._onPositionChanged)}))}return t.prototype.stop=function(){this._symbol&&this._adapter.unsubscribeRealtime(this._symbol,this._onRealtimeBinded),this._adapter.positionUpdate.unsubscribe(this,this._onPositionChanged)},t.prototype._updatePL=function(){if(this._realtimeData&&this._realtimeData.trade&&this._avgPrice){var t=(this._realtimeData.trade-Math.abs(this._avgPrice))*(1===this._side?1:-1);this._host.plUpdate(this._positionId,t)}},t.prototype._onRealtime=function(t,e){this._realtimeData=e,this._updatePL()},t.prototype._onPositionChanged=function(t){this._avgPrice=t.avgPrice,this._updatePL()},t}(),c=i("ogJP"),u=i("aIyQ"),l=i.n(u),d=i("4qhP"),h=function(){function t(t){this._objects={},this._started=!1,this._isObjectsRequestActual=!1,this._ordersPromise=null,this._getter=t,this.updateDelegate=new l.a,this.partialUpdateDelegate=new l.a}return t.prototype.start=function(){this._started||(this._started=!0,this._ordersPromise=this._requestObjects())},t.prototype.stop=function(){this._objects={},this._started=!1,this._ordersPromise=null,this._isObjectsRequestActual=!1},t.prototype.update=function(t,e){this._started&&(this._isObjectsRequestActual?this._isObjectsRequestActual=!1:(this._objects[t.id]=t,this._onObjectUpdated(t,e)))},t.prototype.partialUpdate=function(t,e){if(this._started)if(this._isObjectsRequestActual)this._isObjectsRequestActual=!1;else{var i,r;Object(c.isObject)(t)?(i=t.id,r=t):(i=t,r=Object(s.ensure)(e));var o=this._objects[i];o&&(Object.assign(o,r),this.partialUpdateDelegate.fire(o,r))}},t.prototype.fullUpdate=function(){this._started&&(this._isObjectsRequestActual?this._isObjectsRequestActual=!1:this._ordersPromise=this._requestObjects())},t.prototype.getObjects=function(){return this._ordersPromise||Promise.resolve(Object.values(this._objects))},t.prototype._onObjectUpdated=function(t,e){this.updateDelegate.fire(t,e)},t.prototype._onAllObjectsUpdated=function(){var t=this;this._objectsCache().forEach((function(e){return t.updateDelegate.fire(e,!0)
}))},t.prototype._objectsCache=function(){return Object.values(this._objects)},t.prototype._requestObjects=function(){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(e){switch(e.label){case 0:t=[],e.label=1;case 1:return this._isObjectsRequestActual=!0,[4,this._getter()];case 2:t=e.sent(),e.label=3;case 3:if(!this._isObjectsRequestActual)return[3,1];e.label=4;case 4:return this._objects=Object(d.t)(t,"id"),this._ordersPromise=null,this._isObjectsRequestActual=!1,this._onAllObjectsUpdated(),[2,t]}}))}))},t}(),p=i("txPx"),b=i("d13A"),_=function(t){function e(e,i){var r=t.call(this,e)||this;return r._brokerConfigGetter=i,r}return Object(r.c)(e,t),e.prototype._onObjectUpdated=function(e,i){this._patchTrades(this._objectsCache().filter((function(t){return t.symbol===e.symbol&&0!==t.qty})),e,i),t.prototype._onObjectUpdated.call(this,e,i)},e.prototype._onAllObjectsUpdated=function(){this._patchTrades(this._objectsCache().filter((function(t){return 0!==t.qty}))),t.prototype._onAllObjectsUpdated.call(this)},e.prototype._patchTrades=function(e,i,r){for(var o=this._brokerConfigGetter(),n=0,s=(o.requiresFIFOCloseTrades?o.fifoOnlyForSameQty?v:y:f)(e);n<s.length;n++){var a=s[n];i!==a&&t.prototype._onObjectUpdated.call(this,a,r)}},e}(h);function f(t){for(var e=[],i=0,r=t;i<r.length;i++){var o=r[i];o.canBeClosed||(o.canBeClosed=!0,e.push(o))}return e}function y(t){for(var e={},i=0,r=t;i<r.length;i++){void 0===(c=e[(h=r[i]).symbol])&&(c={oldest:null,all:[]},e[h.symbol]=c),(null===c.oldest||c.oldest.date>h.date)&&(c.oldest=h),c.all.push(h)}for(var o=[],n=0,a=Object.keys(e);n<a.length;n++)for(var c,u=a[n],l=0,d=(c=Object(s.ensureDefined)(e[u])).all;l<d.length;l++){var h=d[l],p=c.oldest===h,b=p!==h.canBeClosed;h.canBeClosed=p,b&&o.push(h)}return o}function v(t){for(var e={},i=0,r=t;i<r.length;i++){var o=e[(v=r[i]).symbol];void 0===o&&(o={},e[v.symbol]=o);var n=o[v.qty];void 0===n&&(n={oldest:null,all:[]},o[v.qty]=n),(null===n.oldest||n.oldest.date>v.date)&&(n.oldest=v),n.all.push(v)}for(var a=[],c=0,u=Object.keys(e);c<u.length;c++)for(var l=u[c],d=Object(s.ensureDefined)(e[l]),h=0,p=Object.keys(d);h<p.length;h++)for(var b=p[h],_=Object(s.ensureDefined)(d[b]),f=0,y=_.all;f<y.length;f++){var v=y[f],m=_.oldest===v,g=m!==v.canBeClosed;v.canBeClosed=m,g&&a.push(v)}return a}var m=i("Lj6W"),g=i("25b6"),k=i("dOnf");function O(t,e){return{symbol:e.symbol,type:2,side:1===e.side?-1:1,qty:Math.abs(t),seenPrice:null}}var w=Object(p.getLogger)("Trading.BrokerConnectionAdapter");function P(t){Object(s.assert)("object"!=typeof t,"Expected not an object")}function B(){return!0}var C=function(){function t(t,e,i,r,o,n){var s=this;this.connectionStatusUpdate=new l.a,this.executionUpdate=new l.a,this.tradingOperationFinished=new l.a,this.currentAccountUpdate=new l.a,this._brokerPlan=null,this._subscriptions={},this._lastFireResult={},this._fakeDomeSubscriptions={},this._formattersCache={},this._spreadFormattersCache={},this._quantityFormattersCache={},this._tradesCache=null,this._profitLossEmitters={},
this._fakePositionUpdateDelegate=null,this._realtimeSubscriptionState=[],this._loggedInManually=!1,this._pendingSubscriptions=[],this.config=Object.assign({},t.configFlags),this._brokerMetainfo=this._patchMetainfo(t),this._brokerPlan=n||null,this._brokerConnection=e,this._host=i,this._tradingStat=o,this._brokerLogger=Object(p.getLogger)("Trading."+this._brokerMetainfo.id+".Connection"),i.setBrokerConnectionAdapter(this),this._initializeConnectProtection(),this._positionsCache=e.positions?new h((function(){return e.positions?e.positions():Promise.resolve([])})):null,this._tradesCache=e.trades?new _((function(){return e.trades?e.trades():Promise.resolve([])}),(function(){return s.config})):null,this._ordersCache=new h((function(){return e.orders()}));var a=function(t){1===t?(null!==s._positionsCache&&s._positionsCache.start(),s._ordersCache.start(),s._tradesCache&&s._tradesCache.start()):(null!==s._positionsCache&&s._positionsCache.stop(),s._ordersCache.stop(),s._tradesCache&&s._tradesCache.stop())};this.connectionStatusUpdate.subscribe(null,a),a(this.connectionStatus()),t.configFlags.supportPLUpdate||(this._brokerConnection.subscribePL=function(t){s._profitLossEmitters[t]=s._createProfitLossEmitter(t)},this._brokerConnection.unsubscribePL=function(t){var e=s._profitLossEmitters[t];e&&(e.stop(),s._profitLossEmitters[t]=null)}),this._originalDOMESubscriptionMethods={subscribeDOME:e.subscribeDOME,unsubscribeDOME:e.unsubscribeDOME},this._patchBrokerSubscribeUnsubscribeDOMEMethods(),this.connectionStatusUpdate.subscribe(null,(function(t){1===t&&s._patchBrokerSubscribeUnsubscribeDOMEMethods()})),t.configFlags.supportPositions||(this._fakePositionUpdateDelegate=new l.a),this._brokerRealtimeAdapter=r}return t.prototype.tryRestoreSession=function(){if(this._brokerConnection.tryRestoreSession)return this._brokerConnection.tryRestoreSession()},Object.defineProperty(t.prototype,"orderUpdate",{get:function(){return this._ordersCache.updateDelegate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"positionUpdate",{get:function(){return null===this._fakePositionUpdateDelegate?Object(s.ensure)(this._positionsCache).updateDelegate:this._fakePositionUpdateDelegate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tradeUpdate",{get:function(){return Object(s.ensure)(this._tradesCache).updateDelegate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"orderPartialUpdate",{get:function(){return this._ordersCache.partialUpdateDelegate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"positionPartialUpdate",{get:function(){return null===this._fakePositionUpdateDelegate?Object(s.ensure)(this._positionsCache).partialUpdateDelegate:this._fakePositionUpdateDelegate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tradePartialUpdate",{get:function(){return Object(s.ensure)(this._tradesCache).partialUpdateDelegate},enumerable:!1,configurable:!0}),t.prototype.onOrderUpdate=function(t){this._ordersCache.update(t)},t.prototype.onOrderPartialUpdate=function(t,e){
this._ordersCache.partialUpdate(t,e)},t.prototype.onPositionUpdate=function(t,e){if(Object(s.assert)(!!this.config.supportPositions,"Broker doesn`t support positions"),0===t.qty){var i=this._lastFireResult[t.symbol];i&&delete i.PL}Object(s.ensure)(this._positionsCache).update(t,e)},t.prototype.onPositionPartialUpdate=function(t,e){Object(s.assert)(!!this.config.supportPositions,"Broker doesn`t support positions"),Object(s.ensure)(this._positionsCache).partialUpdate(t,e)},t.prototype.onTradeUpdate=function(t,e){if(Object(s.assert)(!!this.config.supportTrades,"Broker doesn`t support trades"),0===t.qty){var i=this._lastFireResult[t.symbol];i&&delete i.TradePL}Object(s.ensure)(this._tradesCache).update(t,e)},t.prototype.onTradePartialUpdate=function(t,e){Object(s.ensure)(this._tradesCache).partialUpdate(t,e)},t.prototype.onCurrentAccountChanged=function(){null!==this._positionsCache&&this._positionsCache.fullUpdate(),this._ordersCache.fullUpdate(),this._tradesCache&&this._tradesCache.fullUpdate();var t=this.currentAccount();this.currentAccountUpdate.fire(t)},t.prototype.patchConfig=function(t){Object(m.migrateConfigFlags)(t),Object.assign(this.config,t),Object.assign(this._brokerMetainfo.configFlags,t),this._brokerMetainfo=this._patchMetainfo(this._brokerMetainfo)},t.prototype.getOrderDialogOptions=function(t){return void 0!==this._brokerConnection.getOrderDialogOptions?this._brokerConnection.getOrderDialogOptions(t):void 0},t.prototype.getPositionDialogOptions=function(){return void 0!==this._brokerConnection.getPositionDialogOptions?this._brokerConnection.getPositionDialogOptions():void 0},t.prototype.chartContextMenuActions=function(t,e){return this._brokerConnection.chartContextMenuActions(t,e)},t.prototype.buttonDropdownActions=function(){return this._host.buttonDropdownActions()},t.prototype.connectionStatus=function(){return this._brokerConnection.connectionStatus()},t.prototype.isConnected=function(){return 1===this._brokerConnection.connectionStatus()},t.prototype.signIn=function(t,e,i,r){return this._brokerLogger.logNormal("Try to login with username: "+t),this._loggedInManually=!0,this._brokerConnection.signIn(t,e,i,r)},t.prototype.loggedInManually=function(){return this._loggedInManually},t.prototype.disconnect=function(t){void 0===t&&(t=!1);try{return this._brokerConnection.disconnect(t)}catch(e){w.logWarn("Failed to disconnect")}},t.prototype.currentAccount=function(){return this._brokerConnection.currentAccount?this._brokerConnection.currentAccount():""},t.prototype.currentAccountType=function(){return this._brokerConnection.currentAccountType?this._brokerConnection.currentAccountType():void 0},t.prototype.metainfo=function(){return this._brokerMetainfo},t.prototype.brokerPlan=function(){return this._brokerPlan},t.prototype.bro=function(){return this._brokerConnection},t.prototype.fireSubscription=function(t,e,i,r){if(void 0===this._lastFireResult[e]&&(this._lastFireResult[e]={Realtime:null,PL:null,Equity:null,DOME:null,TradePL:null,PipValue:null,MarginAvailable:null,CryptoBalance:null}),
Object(s.ensure)(this._lastFireResult[e])[t]={data:i,time:Date.now()},void 0!==this._subscriptions[e]){var o=Object(s.ensure)(this._subscriptions[e]);Object(s.ensure)(o[t]).forEach((function(t){return t(e,i,r)}))}},t.prototype.positions=function(t){return this.config.supportPositions?(this._makeSureBrokerIsConnected(),this._positions().then((function(e){return e.filter((function(e){return void 0===t||e.symbol===t}))}))):Promise.resolve([])},t.prototype.disconnectWarningMessage=function(){return this._brokerConnection.disconnectWarningMessage?this._brokerConnection.disconnectWarningMessage():null},t.prototype.trades=function(t){return this._makeSureBrokerIsConnected(),Object(s.assert)(!!this.config.supportTrades,"Broker doesn`t support trades"),this._trades().then((function(e){return e.filter((function(e){return void 0===t||e.symbol===t}))}))},t.prototype.positionById=function(t){return this._brokerConnection.positionById?this._brokerConnection.positionById(t):this.positions().then((function(e){return e.find((function(e){return e.id===t}))})).then((function(t){return t}))},t.prototype.tradeById=function(t){return Object(s.assert)(!!this.config.supportTrades,"Broker doesn`t support trades"),this.trades().then((function(e){return e.find((function(e){return e.id===t}))})).then((function(t){return Object(s.ensure)(t)}))},t.prototype.orders=function(t){return this._makeSureBrokerIsConnected(),this._orders().then((function(e){return e.filter((function(e){return void 0===t||e.symbol===t}))}))},t.prototype.ordersHistory=function(){return this._makeSureBrokerIsConnected(),this.config.supportOrdersHistory&&this._brokerConnection.ordersHistory?this._brokerConnection.ordersHistory():Promise.resolve([])},t.prototype.executions=function(t){return this._makeSureBrokerIsConnected(),this._brokerConnection.executions(t)},t.prototype.orderById=function(t){return this._makeSureBrokerIsConnected(),this._brokerConnection.orders().then((function(e){return e.find((function(e){return e.id===t}))}))},t.prototype.accountManagerInfo=function(){return this._brokerConnection.accountManagerInfo()},t.prototype.isTradable=function(t){var e=this;return this._makeSureBrokerIsConnected(),this._brokerConnection.isTradable(t).then((function(i){return"object"!=typeof i&&(i={tradable:i}),i.tradable||void 0!==i.reason||(i.reason=Object(o.t)("Symbol {symbol} cannot be traded through {broker}.").replace("{symbol}",Object(g.b)(t)).replace("{broker}",e._brokerMetainfo.title)),i}))},t.prototype.formatter=function(t,e){return void 0===e&&(e=!0),this._makeSureBrokerIsConnected(),this._formattersCache[t]||(this._formattersCache[t]=this._brokerConnection.formatter&&this._brokerConnection.formatter(t,e)||this._host.defaultFormatter(t,e)),Object(b.a)(this._formattersCache[t],1e4,"formatter not received")},t.prototype.spreadFormatter=function(t){return this._makeSureBrokerIsConnected(),this._spreadFormattersCache[t]||(this._spreadFormattersCache[t]=this._brokerConnection.spreadFormatter&&this._brokerConnection.spreadFormatter(t)||this._host.defaultFormatter(t,!1)),
Object(b.a)(this._spreadFormattersCache[t],1e4,"spreadFormatter not received")},t.prototype.quantityFormatter=function(t){return this._makeSureBrokerIsConnected(),this._quantityFormattersCache[t]||(this._quantityFormattersCache[t]=this._brokerConnection.quantityFormatter&&this._brokerConnection.quantityFormatter(t)||this._host.quantityFormatter()),Object(b.a)(this._quantityFormattersCache[t],1e4,"quantityFormatter not received")},t.prototype.placeOrder=function(t,e){var i=this;return this._makeSureBrokerIsConnected(),this.processErrors(this._brokerConnection.placeOrder(t,e),!0,Object(o.t)("Order rejected"),(function(){Object(s.ensureNotNull)(i._tradingStat).trackOrderPlaced(t),i._host.trackEvent("","SilentMode",i._host.silentOrdersPlacement().value()?"On":"Off")}))},t.prototype.previewOrder=function(t){if(!this._brokerConnection.previewOrder)throw new Error("Order preview is not supported");return this._brokerConnection.previewOrder(t)},t.prototype.modifyOrder=function(t,e){return this._makeSureBrokerIsConnected(),this.processErrors(this._brokerConnection.modifyOrder(t,e),!0,Object(o.t)("Failed to modify order"))},t.prototype.cancelOrder=function(t){return P(t),this._makeSureBrokerIsConnected(),this.processErrors(this._brokerConnection.cancelOrder(t),!0,Object(o.t)("Failed to cancel order"))},t.prototype.cancelOrders=function(t,e,i){return this._makeSureBrokerIsConnected(),this.processErrors(this._brokerConnection.cancelOrders(t,e,i),!0,Object(o.t)("Failed to cancel one or more orders"))},t.prototype.closePosition=function(t,e){return Object(r.b)(this,void 0,void 0,(function(){var i,n,a,c=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return P(t),this._makeSureBrokerIsConnected(),Object(s.assert)(void 0===e||!!this.config.supportPartialClosePosition,"Broker doesn`t support partial position closing"),n=s.ensureDefined,[4,this.positionById(t)];case 1:return 0===(i=n.apply(void 0,[r.sent()])).qty?(this._host.showNotification(Object(o.t)("Failed to close the position"),Object(o.t)("The position you are trying to close has been already closed."),0),[2,!1]):void 0===e||e<=Math.abs(i.qty)?(a=O(null!=e?e:Math.abs(i.qty),i),this.config.supportClosePosition&&this._brokerConnection.closePosition?[2,this.processErrors(this._brokerConnection.closePosition(t,e),!0,Object(o.t)("Failed to close position"),(function(){return Object(s.ensureNotNull)(c._tradingStat).trackOrderPlaced(a)}))]:[2,this.processErrors(this._brokerConnection.placeOrder(a),!0,Object(o.t)("Failed to close position"),(function(){return Object(s.ensureNotNull)(c._tradingStat).trackOrderPlaced(a)}))]):(this._host.showNotification(Object(o.t)("Failed to close the position"),Object(o.t)("The position you are trying to close has been changed."),0),[2,!1])}}))}))},t.prototype.closeTrade=function(t,e){var i;return Object(r.b)(this,void 0,void 0,(function(){var n,a,c,u=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return P(t),this._makeSureBrokerIsConnected(),
Object(s.assert)(!!this.config.supportTrades,"Broker doesn`t support trades"),Object(s.assert)(void 0===e||null!==(i=this.config.supportPartialCloseTrade)&&void 0!==i&&i,"Broker doesn`t support partial position closing"),a=s.ensureDefined,[4,this.tradeById(t)];case 1:if(0===(n=a.apply(void 0,[r.sent()])).qty)return this._host.showNotification(Object(o.t)("Failed to close the position"),Object(o.t)("The position you are trying to close has been already closed."),0),[2,!1];if(void 0===e||e<=Math.abs(n.qty)){if(this._brokerConnection.closeTrade)return c=O(null!=e?e:Math.abs(n.qty),n),[2,this.processErrors(this._brokerConnection.closeTrade(t,e),!0,Object(o.t)("Failed to close position"),(function(){return Object(s.ensureNotNull)(u._tradingStat).trackOrderPlaced(c)}))];throw new Error("Method closeTrade is not implemented")}return this._host.showNotification(Object(o.t)("Failed to close the position"),Object(o.t)("The position you are trying to close has been changed."),0),[2,!1]}}))}))},t.prototype.reversePosition=function(t){var e,i=this;if(P(t),this._makeSureBrokerIsConnected(),this.config.supportMultiposition&&!this.config.supportNativeReversePosition)throw new Error("Cannot reverse position on multiposition account");var r=new Promise((function(r){var o;null===(o=i._positionsCache)||void 0===o||o.getObjects().then((function(o){var n,s=o.find((function(e){return e.id===t}));if(void 0===s||0===s.qty)return i._brokerLogger.logError("Failed to reverse position: Position not found"),void r(!1);e=function(t){var o;t.symbol===s.symbol&&t.side!==s.side&&(null===(o=i._positionsCache)||void 0===o||o.updateDelegate.unsubscribe(i,e),r(!0))},null===(n=i._positionsCache)||void 0===n||n.updateDelegate.subscribe(i,e),i._reversePosition(t).then((function(t){var o;t||(null===(o=i._positionsCache)||void 0===o||o.updateDelegate.unsubscribe(i,e),r(!1))}))}))}));return Object(b.a)(r,1e4,"Timeout").catch((function(t){var r;return i._brokerLogger.logError("Failed to reverse position: "+Object(d.j)(t)),null===(r=i._positionsCache)||void 0===r||r.updateDelegate.unsubscribe(i,e),!1}))},t.prototype.editPositionBrackets=function(t,e,i){if(this._makeSureBrokerIsConnected(),this._brokerConnection.editPositionBrackets)return this.processErrors(this._brokerConnection.editPositionBrackets(t,e,i),!0,$.t("Failed to modify Stop Loss / Take Profit"));throw new Error("Method editPositionBrackets is not implemented")},t.prototype.editTradeBrackets=function(t,e){if(this._makeSureBrokerIsConnected(),Object(s.assert)(!!this.config.supportTradeBrackets,"Broker doesn`t support brackets on trades"),this._brokerConnection.editTradeBrackets)return this.processErrors(this._brokerConnection.editTradeBrackets(t,e),!0,$.t("Failed to modify Stop Loss / Take Profit"));throw new Error("Method editTradeBrackets is not implemented")},t.prototype.subscribeRealtime=function(t,e){return Object(r.b)(this,void 0,void 0,(function(){var i,o,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return this._makeSureBrokerIsConnected(),i={symbol:t,listener:e,provider:0},
this._realtimeSubscriptionState.push(i),[4,this.symbolInfo(t)];case 1:return o=r.sent(),-1===(n=this._realtimeSubscriptionState.findIndex((function(i){return i.symbol===t&&i.listener===e})))?[2]:void 0!==o.hasQuotes&&!1===o.hasQuotes?(this._realtimeSubscriptionState[n].provider=1,[2,Object(s.ensure)(this._brokerRealtimeAdapter).subscribeRealtime(t,e)]):(this._realtimeSubscriptionState[n].provider=2,[2,this._addSubscription("Realtime",t,e)])}}))}))},t.prototype.quotesSnapshot=function(t){var e=this,i=null;return Object(b.a)(new Promise((function(r){var o=function(t,n){i=n,n&&(n.ask||n.bid)&&(e.unsubscribeRealtime(t,o),r(n))};e.subscribeRealtime(t,o)})),1e4,"quotesSnapshot not received").catch((function(t){if(null!==i)return i;throw t}))},t.prototype.subscribeDOME=function(t,e){return this._makeSureBrokerIsConnected(),this._addSubscription("DOME",t,e)},t.prototype.subscribePipValue=function(t,e){return this._makeSureBrokerIsConnected(),this._addSubscription("PipValue",t,e)},t.prototype.subscribePL=function(t,e){return this._makeSureBrokerIsConnected(),this._addSubscription("PL",t,e)},t.prototype.subscribeTradePL=function(t,e){return this._makeSureBrokerIsConnected(),this._addSubscription("TradePL",t,e)},t.prototype.subscribeCryptoBalance=function(t,e){return this._makeSureBrokerIsConnected(),this._addSubscription("CryptoBalance",t,e)},t.prototype.subscribeEquity=function(t){return this._makeSureBrokerIsConnected(),this._addSubscription("Equity","Equity",t)},t.prototype.subscribeMarginAvailable=function(t){return this._makeSureBrokerIsConnected(),this._addSubscription("MarginAvailable","MarginAvailable",t)},t.prototype.unsubscribeRealtime=function(t,e){var i=this._realtimeSubscriptionState.findIndex((function(i){return i.symbol===t&&i.listener===e}));-1!==i&&(1===this._realtimeSubscriptionState[i].provider?Object(s.ensure)(this._brokerRealtimeAdapter).unsubscribeRealtime(t,e):this._removeSubscription("Realtime",t,e),this._realtimeSubscriptionState.splice(i,1))},t.prototype.unsubscribeDOME=function(t,e){this._removeSubscription("DOME",t,e)},t.prototype.unsubscribePipValue=function(t,e){this._removeSubscription("PipValue",t,e)},t.prototype.unsubscribePL=function(t,e){this._removeSubscription("PL",t,e)},t.prototype.unsubscribeTradePL=function(t,e){this._removeSubscription("TradePL",t,e)},t.prototype.unsubscribeCryptoBalance=function(t,e){this._removeSubscription("CryptoBalance",t,e)},t.prototype.unsubscribeEquity=function(t){this._removeSubscription("Equity","Equity",t)},t.prototype.unsubscribeMarginAvailable=function(t){this._removeSubscription("MarginAvailable","MarginAvailable",t)},t.prototype.accountMetainfo=function(){return Object(r.b)(this,void 0,void 0,(function(){var t,e,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this.accountsMetainfo()];case 1:if(t=r.sent(),e=this.currentAccount(),void 0===(i=t.find((function(t){return t.id===e}))))throw new Error("accountMetainfo not received");return[2,i]}}))}))},t.prototype.accountsMetainfo=function(){
return Object(b.a)(this._brokerConnection.accountsMetainfo(),1e4,"accountsMetainfo not received")},t.prototype.setCurrentAccount=function(t){if(void 0===this._brokerConnection.setCurrentAccount)throw new Error(this._brokerMetainfo.title+" doesn't support sub-accounts");this._brokerConnection.setCurrentAccount(t)},t.prototype.symbolInfo=function(t){return Object(b.a)(this._brokerConnection.symbolInfo(t),1e4,"symbolInfo not received")},t.prototype.bugReportInfo=function(){var t=this;function e(t){return JSON.parse(JSON.stringify(t))}function i(t){if("object"!=typeof t)return t;if(Object(c.isArray)(t))return t.map(i);var e={};for(var r in t)"object"!=typeof t[r]&&(e[r]=t[r]);return e}return Promise.all([this.orders(),this.positions(),this.config.supportTrades?this.trades():Promise.resolve([])]).then((function(r){return{activeBroker:t.metainfo().title,orders:i(e(r[0])),positions:i(e(r[1])),trades:i(e(r[2])),silentOrdersPlacement:t._host.silentOrdersPlacement().value(),floatingPanel:Object(s.ensureNotNull)(t._host.sellBuyButtonsVisibility()).value(),account:t.currentAccount(),accountType:t.currentAccountType(),lastUpdates:t._lastFireResult,time:Date.now(),brokerSpecific:t._brokerConnection.bugReportInfo?t._brokerConnection.bugReportInfo():null}}))},t.prototype.processErrors=function(t,e,i,r){var s=this;if(!Object(c.isPromise)(t))throw new Error("Broker incorrectly implements API, should return Promise");return t.then(r).then(B).catch((function(t){var r="";return"string"==typeof t?r=t:"object"==typeof t&&"string"==typeof t.message&&(r=t.message),e&&n.enabled("trading_notifications")?(0!==r.length&&("."!==r.slice(-1)&&(r+="."),r+=" "),r+=Object(o.t)("To learn more, please contact your broker."),s._host.showNotification(i||"",r,0)):w.logWarn(t),Promise.resolve(!1)})).then((function(t){return s.tradingOperationFinished.fire(t),t}))},t.prototype.setDurations=function(t){this._brokerMetainfo.durations=t.slice()},t.prototype.setSymbolSearchId=function(t){this._brokerMetainfo.backendBrokerName=t},t.prototype.getRealtimeDataCheckParams=function(){return this._brokerConnection.getRealtimeDataCheckParams?this._brokerConnection.getRealtimeDataCheckParams():{}},t.prototype.getVerifyLiveAccountParams=function(){if(void 0===this._brokerConnection.getVerifyLiveAccountParams)throw new Error("Method getVerifyLiveAccountParams for broker "+this._brokerMetainfo.id+" is not implemented");return this._brokerConnection.getVerifyLiveAccountParams()},t.prototype.unhideSymbolSearchGroups=function(){return this._brokerConnection.unhideSymbolSearchGroups?this._brokerConnection.unhideSymbolSearchGroups():[]},t.prototype.destroy=function(){void 0!==this._brokerConnection.destroy&&this._brokerConnection.destroy()},t.prototype.currentBroker=function(){return this._brokerMetainfo.id},t.prototype._initializeConnectProtection=function(){var t=this,e=null;this.connectionStatusUpdate.subscribe(null,(function(i){if(e&&(clearTimeout(e),e=null),2===i){var r=Object(d.m)(t.config.authorizationType)?18e4:6e4;e=setTimeout((function(){t._host.selectBroker(),
t._host.showNotification(Object(o.t)("Authorization Error"),Object(o.t)("The connection attempt failed. Please try again later."))}),r)}}))},t.prototype._fakeSubscribeDOME=function(t){var e=this;this._fakeDomeSubscriptions[t]=function(t,i){var r=i.ask||i.trade,o=i.bid||i.trade,n={snapshot:!0,asks:r?[{price:r,volume:i.ask_size||1/0}]:[],bids:o?[{price:o,volume:i.bid_size||1/0}]:[]};e._host.domeUpdate(t,n)},this.subscribeRealtime(t,this._fakeDomeSubscriptions[t])},t.prototype._fakeUnsubscribeDOME=function(t){this.unsubscribeRealtime(t,this._fakeDomeSubscriptions[t])},t.prototype._isMaintenance=function(){return isFeatureEnabled(Object(d.r)(this._brokerMetainfo.id))},t.prototype._isBrokerSideMaintenance=function(){return isFeatureEnabled(Object(d.q)(this._brokerMetainfo.id))},t.prototype._patchBrokerSubscribeUnsubscribeDOMEMethods=function(){var t=this,e=!this._brokerMetainfo.configFlags.supportLevel2Data;this._brokerConnection.subscribeDOME=e?function(e){t._fakeSubscribeDOME(e)}:this._originalDOMESubscriptionMethods.subscribeDOME,this._brokerConnection.unsubscribeDOME=e?function(e){t._fakeUnsubscribeDOME(e)}:this._originalDOMESubscriptionMethods.unsubscribeDOME},t.prototype._createProfitLossEmitter=function(t){return new a(t,this,this._host)},t.prototype._patchMetainfo=function(t){var e=Object(k.deepCopy)(t);return e.configFlags.supportNativeReversePosition=!this.config.supportMultiposition||this.config.supportNativeReversePosition,e.configFlags.supportClosePosition=!0,e.configFlags.supportPLUpdate=!0,e},t.prototype._addSubscription=function(t,e,i){this._pendingSubscriptions.push({brokerMethodName:t,symbol:e,listener:i});var r=this._lastFireResult[e];if(void 0!==r&&void 0!==r[t]&&null!==r[t]&&i(e,r[t].data),this._removePendingSubscription({brokerMethodName:t,symbol:e,listener:i})){void 0===this._subscriptions[e]&&(this._subscriptions[e]={Realtime:[],PL:[],Equity:[],DOME:[],TradePL:[],PipValue:[],MarginAvailable:[],CryptoBalance:[]});var o=Object(s.ensure)(this._subscriptions[e]),n=o[t].length>0;if(o[t].push(i),!n&&(o[t].length>0||"CryptoBalance"===t)){var a="subscribe"+t;this._brokerConnection[a]&&this._brokerConnection[a](e)}}},t.prototype._removePendingSubscription=function(t){var e=this._pendingSubscriptions.findIndex((function(e){return e.symbol===t.symbol&&e.brokerMethodName===t.brokerMethodName&&e.listener===t.listener}));return-1!==e&&(this._pendingSubscriptions.splice(e,1),!0)},t.prototype._removeSubscription=function(t,e,i){if(!this._removePendingSubscription({brokerMethodName:t,symbol:e,listener:i})&&void 0!==this._subscriptions[e]){var r=Object(s.ensure)(this._subscriptions[e]),o=r[t].indexOf(i);if(o>-1&&r[t].splice(o,1),0===r[t].length){var n="unsubscribe"+t;this._brokerConnection[n]&&this._brokerConnection[n](e)}}},t.prototype._positions=function(){return this._positionsCache?this._positionsCache.getObjects():Promise.resolve([])},t.prototype._trades=function(){return this._tradesCache?this._tradesCache.getObjects():Promise.resolve([])},t.prototype._orders=function(){return this._ordersCache.getObjects()},
t.prototype._makeSureBrokerIsConnected=function(){Object(s.assert)(1===this.connectionStatus(),"Broker is not connected")},t.prototype._placeReversePositionOrder=function(t){var e={qty:2*Math.abs(t.qty),side:1===t.side?-1:1,symbol:t.symbol,brokerSymbol:t.brokerSymbol,type:2,seenPrice:null};return this.placeOrder(e)},t.prototype._reversePosition=function(t){var e=this;return this.config.supportNativeReversePosition&&this._brokerConnection.reversePosition?this.processErrors(this._brokerConnection.reversePosition(t),!0,window.t("Failed to reverse position")):this.positionById(t).then((function(t){var i=Object(s.ensureDefined)(t);return e.processErrors(e._placeReversePositionOrder(i),!0,Object(o.t)("Failed to reverse position"),(function(){return Object(s.ensureNotNull)(e._tradingStat).trackOrderPlaced()}))}))},t}(),S=i("1rjR"),j=i("QBLL"),E=i("C9TK"),T=i("hY0g"),D=i.n(T),N=i("Vdly"),I=i.n(N),A=i("jCNj"),L=i("zXvd"),V=i("cUJV"),M=i("5XxY"),R=i("IWXC"),U=Object(p.getLogger)("Trading.CredentialsWebStorage"),q=function(){function t(t){this._storage=t}return t.prototype.setItem=function(t,e){try{var i=Object(c.isObject)(e)?JSON.stringify(e):String(e);this._storage.setItem(t,i)}catch(r){U.logError("Unable to save credentials using key "+t+": "+r.message)}},t.prototype.getItem=function(t,e){void 0===e&&(e=null);var i=e,r=this._storage.getItem(t);if(null===r)return i;try{i=JSON.parse(r)}catch(o){i=r}return i},t.prototype.removeItem=function(t){this._storage.removeItem(t)},t}(),F=function(t){function e(){return t.call(this,localStorage)||this}return Object(r.c)(e,t),e}(q),x=function(t){function e(){return t.call(this,sessionStorage)||this}return Object(r.c)(e,t),e}(q),W=function(){function t(t,e){this._localStorageProvider=null,this._sessionStorageProvider=null,this._brokerId=t.toLowerCase(),this._rememberCredentials=e}return t.prototype.save=function(t,e){this._currentStorageProvider().setItem(this._brokerId+"."+t,e)},t.prototype.load=function(t,e){return this._currentStorageProvider().getItem(this._brokerId+"."+t,e)},t.prototype.clear=function(t){this._currentStorageProvider().removeItem(this._brokerId+"."+t)},t.prototype._currentStorageProvider=function(){return this._rememberCredentials.value()?(null===this._localStorageProvider&&(this._localStorageProvider=new F),this._localStorageProvider):(null===this._sessionStorageProvider&&(this._sessionStorageProvider=new x),this._sessionStorageProvider)},t}(),Q=i("Y/3S"),H=i("kcTO"),z=function(){function t(t,e){var i;this._setDefaultDropdownActionsBound=this._setDefaultDropdownActions.bind(this),this._trading=t,this._metainfo=e,this._setDefaultDropdownActionsBound=this._setDefaultDropdownActions.bind(this),this._defaultDropdownActions=!0,this._credentialsStorage=new W(this._metainfo.id,new Q.a(this._metainfo.id)),this._setDefaultDropdownActions(),null!==this._trading&&(null===(i=this.sellBuyButtonsVisibility())||void 0===i||i.subscribe(this._setDefaultDropdownActionsBound),Object(s.ensureNotNull)(this.orderPanelVisibility()).subscribe(this._setDefaultDropdownActionsBound),
Object(s.ensureNotNull)(this.domPanelVisibility()).subscribe(this._setDefaultDropdownActionsBound))}return t.prototype.getLogger=function(){return Object(p.getLogger)("Trading."+this._metainfo.id)},t.prototype.translate=function(t){return t},t.prototype.setBrokerConnectionAdapter=function(t){this._adapter=t},t.prototype.patchConfig=function(t){this._adapter.patchConfig(t)},t.prototype.showOrderDialog=function(t,e){return Object(s.ensureNotNull)(this._trading).orderViewController().showOrderView(this._adapter,t,e)},t.prototype.showPositionBracketsDialog=function(t,e,i){return Object(s.ensureNotNull)(this._trading).orderViewController().showPositionView(this._adapter,t,e,i)},t.prototype.showCancelOrderDialog=function(t,e){var i=this;return S.a.get().open(t).then((function(t){t&&i._adapter.processErrors(e(),!0,$.t("Failed to cancel order"))}))},t.prototype.showCancelMultipleOrdersDialog=function(t,e,i,r){var o=this;return S.a.get().multiple(t,e,i).then((function(t){t&&o._adapter.processErrors(r(),!0,$.t("Failed to cancel one or more orders"))}))},t.prototype.showCancelBracketsDialog=function(t,e){var i=this;return j.a.get().open(t).then((function(t){t&&i._adapter.processErrors(e(),!0,$.t("Failed to cancel brackets"))}))},t.prototype.showCancelMultipleBracketsDialog=function(t,e){var i=this;return j.a.get().multiple(t).then((function(t){t&&i._adapter.processErrors(e(),!0,$.t("Failed to cancel brackets"))}))},t.prototype.showReversePositionDialog=function(t,e){return Object(E.a)(t,Object(s.ensureNotNull)(this._trading).showErrorNotification,e)},t.prototype.showMessageDialog=function(t,e){M.a.show(t,e)},t.prototype.setDurations=function(t){this._adapter.setDurations(t)},t.prototype.setSymbolSearchId=function(t){this._adapter.setSymbolSearchId(t)},t.prototype.activateBottomWidget=function(){return null!==this._trading?this._trading.toggleTradingWidget():Promise.reject("Activate bottom widget failed: trading is not defined")},t.prototype.trackEvent=function(t,e,i){null!==this._trading&&this._trading.trackEvent(t,e,i)},t.prototype.defaultFormatter=function(t,e){return Object(R.getQuoteSessionInstance)("simple").formatter(t,e)},t.prototype.numericFormatter=function(t){return Promise.resolve(new L.NumericFormatter(t))},t.prototype.quantityFormatter=function(t){return Promise.resolve(new V.a(t))},t.prototype.selectBroker=function(){null!==this._trading&&this._trading.selectBroker(null)},t.prototype.showTradingProperties=function(){null!==this._trading&&this._trading.showTradingProperties()},t.prototype.symbolSnapshot=function(t){return Object(R.getQuoteSessionInstance)("full").snapshot(t)},t.prototype.suggestedQty=function(){return Object(s.ensureNotNull)(this._trading).suggestedQty()},t.prototype.silentOrdersPlacement=function(){return Object(s.ensureNotNull)(this._trading).noConfirmEnabled},t.prototype.sellBuyButtonsVisibility=function(){return null!==this._trading&&n.enabled("buy_sell_buttons")?this._trading.showSellBuyButtons:null},t.prototype.domPanelVisibility=function(){
return null!==this._trading?this._trading.domPanelVisibility():null},t.prototype.orderPanelVisibility=function(){return null!==this._trading?this._trading.orderPanelVisibility():null},t.prototype.showPricesWithZeroVolume=function(){return Object(s.ensureNotNull)(this._trading).showPricesWith().zeroVolume},t.prototype.showNotification=function(t,e,i){void 0===i&&(i=0),null!==this._trading&&(0===i?this._trading.showErrorNotification(t,e):this._trading.showSuccessNotification(t,e))},t.prototype.connectionStatusUpdate=function(t,e){this._adapter.connectionStatusUpdate.fire(t,e),1===t&&this._setDefaultDropdownActions()},t.prototype.orderUpdate=function(t){this._adapter.onOrderUpdate(t)},t.prototype.positionUpdate=function(t,e){this._adapter.onPositionUpdate(t,e)},t.prototype.tradeUpdate=function(t,e){this._adapter.onTradeUpdate(t,e)},t.prototype.orderPartialUpdate=function(t,e){this._adapter.onOrderPartialUpdate(t,e)},t.prototype.positionPartialUpdate=function(t,e){this._adapter.onPositionPartialUpdate(t,e)},t.prototype.tradePartialUpdate=function(t,e){this._adapter.onTradePartialUpdate(t,e)},t.prototype.executionUpdate=function(t){this._adapter.executionUpdate.fire(t)},t.prototype.currentAccountUpdate=function(){this._adapter.onCurrentAccountChanged()},t.prototype.realtimeUpdate=function(t,e){this._adapter.fireSubscription("Realtime",t,e)},t.prototype.domeUpdate=function(t,e){this._adapter.fireSubscription("DOME",t,e)},t.prototype.pipValueUpdate=function(t,e){this._adapter.fireSubscription("PipValue",t,e)},t.prototype.plUpdate=function(t,e){this._adapter.fireSubscription("PL",t,e)},t.prototype.tradePLUpdate=function(t,e){this._adapter.fireSubscription("TradePL",t,e)},t.prototype.equityUpdate=function(t){this._adapter.fireSubscription("Equity","Equity",t)},t.prototype.marginAvailableUpdate=function(t){this._adapter.fireSubscription("MarginAvailable","MarginAvailable",t)},t.prototype.cryptoBalanceUpdate=function(t,e){this._adapter.fireSubscription("CryptoBalance",t,e)},t.prototype.setButtonDropdownActions=function(t){var e;null!==this._trading&&this._defaultDropdownActions&&(this._defaultDropdownActions=!1,null===(e=this.sellBuyButtonsVisibility())||void 0===e||e.unsubscribe(this._setDefaultDropdownActionsBound),Object(s.ensureNotNull)(this.orderPanelVisibility()).unsubscribe(this._setDefaultDropdownActionsBound),Object(s.ensureNotNull)(this.domPanelVisibility()).unsubscribe(this._setDefaultDropdownActionsBound)),this._buttonDropdownActions=t},t.prototype.buttonDropdownActions=function(){return this._buttonDropdownActions},t.prototype.defaultContextMenuActions=function(){for(var t,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return null!==this._trading?(t=this._trading).defaultContextMenuActions.apply(t,e):Promise.resolve([])},t.prototype.defaultDropdownMenuActions=function(t){return null!==this._trading?this._trading.defaultDropdownMenuActions(t):[]},Object.defineProperty(t.prototype,"factory",{get:function(){return{createDelegate:function(){return new l.a},createWatchedValue:function(t){return new D.a(t)},
createPriceFormatter:function(t,e,i,r){return new H.PriceFormatter(t,e,i,r)}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"settings",{get:function(){var t=this;return{save:function(e,i){return I.a.setJSON(t._metainfo.id+"."+e,i)},load:function(e,i){return I.a.getJSON(t._metainfo.id+"."+e,i)},clear:function(e,i){return I.a.remove(t._metainfo.id+"."+e,i)}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"credentialsStorage",{get:function(){var t=this;return{save:function(e,i){return t._credentialsStorage.save(e,i)},load:function(e,i){return t._credentialsStorage.load(e,i)},clear:function(e){return t._credentialsStorage.clear(e)}}},enumerable:!1,configurable:!0}),t.prototype.createMapper=function(t){return{tvToBroker:function(t){return t},brokerToTv:function(t){return t}}},t.prototype.createMapperSync=function(t,e){var i=Promise.resolve();return{ready:function(){return i},tvToBroker:function(t){return t},brokerToTv:function(t){return t}}},t.prototype.convertTimezone=function(t,e,i){var r=A.get_timezone(e),o=A.get_timezone(i),n=A.cal_to_utc(r,t);return A.utc_to_cal(o,n)},t.prototype.language=function(){return window.language},t.prototype.getUserSpecificHash=function(){return window.user.private_channel||""},t.prototype.activateFXCMCFD=function(){I.a.setValue("fxcm_cfd",!0)},t.prototype._setDefaultDropdownActions=function(){null!==this._trading&&this._defaultDropdownActions&&(this._buttonDropdownActions=this.defaultDropdownMenuActions())},t}(),G=i("U/Is"),K=i("E9hm");i.d(e,"addBroker",(function(){return Y})),i.d(e,"brokersList",(function(){return X})),i.d(e,"createBrokerConnection",(function(){return Z}));var J=[];function Y(t,e){t.configFlags=Object(K.a)(t.configFlags),J.push({metainfo:t,createBrokerFunction:e})}function X(){return J.map((function(t){return t.metainfo}))}function Z(t,e,i){return new Promise((function(r){var o=J.filter((function(t){return t.metainfo.id===e}))[0],n=new z(t,o.metainfo);o.createBrokerFunction(n,(function(e){var s=new G.a(o.metainfo.id);r(new C(o.metainfo,e,n,s,t&&t.tradingStat(),i))}))}))}},LVLx:function(t,e,i){"use strict";!function(t){function e(t){return t instanceof Node?t:document.createTextNode(String(t))}for(var i=0,r=[Element.prototype,Document.prototype,DocumentFragment.prototype];i<r.length;i++){var o=r[i];if(o.hasOwnProperty("append"))return;Object.defineProperty(o,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(1!==t.length){for(var r=document.createDocumentFragment(),o=0,n=t;o<n.length;o++){var s=n[o];r.appendChild(e(s))}this.appendChild(r)}else this.appendChild(e(t[0]))}})}}()},N8pX:function(t,e,i){t.exports={"css-value-padding":"4px",wrapper:"wrapper-5xpFx6a0",column:"column-3kQxstaD",button:"button-38v414pK",sellButton:"sellButton-10BFFA8V",buyButton:"buyButton-2iXIWbwn",brokerButton:"brokerButton-1VFHQnjf",highButtons:"highButtons-3LT7iDtG",withoutBg:"withoutBg-1-yXoW7u",lastCharSup:"lastCharSup-s7mvzQye",spreadQtyWrapper:"spreadQtyWrapper-2JNciA9_",
spread:"spread-1n3Ytru8",withoutQty:"withoutQty-3QBZGJie",qty:"qty-10Yvbssx",loader:"loader-wlUaa8hg",loading:"loading-FjlaozRw",buttonText:"buttonText-1vopxN9j",brokerButtonIconWrap:"brokerButtonIconWrap-B24aGt7r",brokerButtonDefault:"brokerButtonDefault-A1U8FBMz",touchMode:"touchMode-akjMUe2p",buttons:"buttons-3NsbIAqS"}},NQw4:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("mrSG");function o(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([i.e("react"),i.e(1),i.e(4),i.e(7),i.e(9),i.e(15),i.e(16),i.e(0),i.e(6),i.e("trading-dialog")]).then(i.bind(null,"Hqag"))];case 1:return[2,new(0,t.sent().TradingDialogRenderer)]}}))}))}},OKVU:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 16" width="20" height="16" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M7.5 2.5C7.5 1.67 8.17 1 9 1h2c.83 0 1.5.67 1.5 1.5v.15h-5V2.5zm6 0v.15H17a2.5 2.5 0 0 1 2.5 2.5v8.35A2.5 2.5 0 0 1 17 16H3a2.5 2.5 0 0 1-2.5-2.5V5.15A2.5 2.5 0 0 1 3 2.65h3.5V2.5A2.5 2.5 0 0 1 9 0h2a2.5 2.5 0 0 1 2.5 2.5zm-12 2.65c0-.83.67-1.5 1.5-1.5h14c.83 0 1.5.67 1.5 1.5v8.35c0 .83-.67 1.5-1.5 1.5H3a1.5 1.5 0 0 1-1.5-1.5V5.15zM9.25 6.5a1.75 1.75 0 1 0 0 3.5h1.5a.75.75 0 0 1 0 1.5h-1.5a.75.75 0 0 1-.75-.75h-1c0 .97.78 1.75 1.75 1.75h.25v1h1v-1h.25a1.75 1.75 0 1 0 0-3.5h-1.5a.75.75 0 0 1 0-1.5h1.5c.41 0 .75.34.75.75h1c0-.97-.78-1.75-1.75-1.75h-.25v-1h-1v1h-.25z"/></svg>'},QBLL:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i("mrSG"),o=(i("HbRj"),i("YFKU"),i("5det")),n={get:function(){return this},open:function(t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Object(o.a)(window.t("Cancel Bracket"),window.t("Are you sure you want to cancel {orderId}bracket?").format({orderId:t?t+" ":""}))]}))}))},multiple:function(t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Object(o.a)(window.t("Cancel Bracket"),window.t("Are you sure you want to cancel {orderId}brackets?").format({orderId:t?t+" ":""}))]}))}))}}},"Y/3S":function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i("Vdly"),o=i.n(r),n=function(){function t(t){this._settingsKey="trading."+t+".rememberCredentials"}return t.prototype.value=function(){return o.a.getBool(this._settingsKey,!0)},t.prototype.setValue=function(t){o.a.setValue(this._settingsKey,t)},t}()},fBig:function(t,e,i){t.exports={loader:"loader-1ON1rkY9",loaderItem:"loaderItem-6asdclOe","loader-animation":"loader-animation-1vbmOmyN",shown:"shown-1QFCxvPl",touchMode:"touchMode-I-CBM3V3"}},qBrV:function(t,e,i){"use strict";function r(t,e){null===t.firstChild?t.textContent=e:t.firstChild.nodeValue=e}i.d(e,"a",(function(){return r}))},vOQ2:function(t,e,i){"use strict";var r;i.d(e,"d",(function(){return r})),i.d(e,"a",(function(){return o})),i.d(e,"c",(function(){return n})),i.d(e,"b",(function(){return s})),function(t){t.DomPanel="domPanel",
t.OrderPanel="orderPanel"}(r||(r={}));var o=400,n=315,s=451}}]);